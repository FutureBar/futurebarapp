/*
 
 jQuery Tools @VERSION Tooltip - UI essentials

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/tooltip/

 Since: November 2008
 Date: @DATE 
*/
(function(b,a){function c(a){return!b(a).parents().andSelf().filter(function(){return"hidden"===b.curCSS(this,"visibility")||b.expr.filters.hidden(this)}).length}function d(a,d){var g=a.nodeName.toLowerCase();if("area"===g){var g=a.parentNode,h=g.name;if(!a.href||!h||"map"!==g.nodeName.toLowerCase())return!1;g=b("img[usemap=#"+h+"]")[0];return!!g&&c(g)}return(/input|select|textarea|button|object/.test(g)?!a.disabled:"a"==g?a.href||d:d)&&c(a)}b.ui=b.ui||{};b.ui.version||(b.extend(b.ui,{version:"1.8.18",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),b.fn.extend({propAttr:b.fn.prop||b.fn.attr,_focus:b.fn.focus,focus:function(a,d){return"number"==typeof a?this.each(function(){var c=
this;setTimeout(function(){b(c).focus();d&&d.call(c)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;b.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?a=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.curCSS(this,"position",1))&&/(auto|scroll)/.test(b.curCSS(this,"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1))}).eq(0):a=this.parents().filter(function(){return/(auto|scroll)/.test(b.curCSS(this,
"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?b(document):a},zIndex:function(d){if(d!==a)return this.css("zIndex",d);if(this.length)for(var d=b(this[0]),c;d.length&&d[0]!==document;){c=d.css("position");if("absolute"===c||"relative"===c||"fixed"===c)if(c=parseInt(d.css("zIndex"),10),!isNaN(c)&&0!==c)return c;d=d.parent()}return 0},disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(b){b.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),b.each(["Width","Height"],function(d,c){function g(a,d,c,e){b.each(h,function(){d-=parseFloat(b.curCSS(a,"padding"+this,!0))||0;c&&(d-=parseFloat(b.curCSS(a,"border"+this+"Width",!0))||0);e&&(d-=parseFloat(b.curCSS(a,"margin"+this,!0))||0)});return d}var h="Width"===c?["Left","Right"]:["Top","Bottom"],i=c.toLowerCase(),j={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,
outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+c]=function(d){return d===a?j["inner"+c].call(this):this.each(function(){b(this).css(i,g(this,d)+"px")})};b.fn["outer"+c]=function(a,d){return"number"!=typeof a?j["outer"+c].call(this,a):this.each(function(){b(this).css(i,g(this,a,!0,d)+"px")})}}),b.extend(b.expr[":"],{data:function(a,d,c){return!!b.data(a,c[3])},focusable:function(a){return d(a,!isNaN(b.attr(a,"tabindex")))},tabbable:function(a){var c=b.attr(a,"tabindex"),g=isNaN(c);
return(g||0<=c)&&d(a,!g)}}),b(function(){var a=document.body,d=a.appendChild(d=document.createElement("div"));d.offsetHeight;b.extend(d.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});b.support.minHeight=100===d.offsetHeight;b.support.selectstart="onselectstart"in d;a.removeChild(d).style.display="none"}),b.extend(b.ui,{plugin:{add:function(a,d,c){var a=b.ui[a].prototype,h;for(h in c)a.plugins[h]=a.plugins[h]||[],a.plugins[h].push([d,c[h]])},call:function(b,a,d){if((a=b.plugins[a])&&
b.element[0].parentNode)for(var c=0;c<a.length;c++)b.options[a[c][0]]&&a[c][1].apply(b.element,d)}},contains:function(b,a){return document.compareDocumentPosition?b.compareDocumentPosition(a)&16:b!==a&&b.contains(a)},hasScroll:function(a,d){if("hidden"===b(a).css("overflow"))return!1;var c=d&&"left"===d?"scrollLeft":"scrollTop",h=!1;if(0<a[c])return!0;a[c]=1;h=0<a[c];a[c]=0;return h},isOverAxis:function(b,a,d){return b>a&&b<a+d},isOver:function(a,d,c,h,i,j){return b.ui.isOverAxis(a,c,i)&&b.ui.isOverAxis(d,
h,j)}}))})(jQuery);
(function(b,a){if(b.cleanData){var c=b.cleanData;b.cleanData=function(a){for(var d=0,g;null!=(g=a[d]);d++)try{b(g).triggerHandler("remove")}catch(h){}c(a)}}else{var d=b.fn.remove;b.fn.remove=function(a,c){return this.each(function(){c||(!a||b.filter(a,[this]).length)&&b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(a){}});return d.call(b(this),a,c)})}}b.widget=function(a,d,c){var h=a.split(".")[0],i,a=a.split(".")[1];i=h+"-"+a;c||(c=d,d=b.Widget);b.expr[":"][i]=
function(d){return!!b.data(d,a)};b[h]=b[h]||{};b[h][a]=function(b,a){arguments.length&&this._createWidget(b,a)};d=new d;d.options=b.extend(!0,{},d.options);b[h][a].prototype=b.extend(!0,d,{namespace:h,widgetName:a,widgetEventPrefix:b[h][a].prototype.widgetEventPrefix||a,widgetBaseClass:i},c);b.widget.bridge(a,b[h][a])};b.widget.bridge=function(d,c){b.fn[d]=function(g){var h="string"==typeof g,i=Array.prototype.slice.call(arguments,1),j=this,g=!h&&i.length?b.extend.apply(null,[!0,g].concat(i)):g;if(h&&
"_"===g.charAt(0))return j;h?this.each(function(){var c=b.data(this,d),f=c&&b.isFunction(c[g])?c[g].apply(c,i):c;if(f!==c&&f!==a)return j=f,!1}):this.each(function(){var a=b.data(this,d);a?a.option(g||{})._init():b.data(this,d,new c(g,this))});return j}};b.Widget=function(b,a){arguments.length&&this._createWidget(b,a)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(a,d){b.data(d,this.widgetName,this);this.element=b(d);this.options=b.extend(!0,
{},this.options,this._getCreateOptions(),a);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(d,c){var g=d;if(0===arguments.length)return b.extend({},this.options);if("string"==typeof d){if(c===a)return this.options[d];g={};g[d]=c}this._setOptions(g);return this},_setOptions:function(a){var d=this;b.each(a,function(b,a){d._setOption(b,a)});return this},_setOption:function(b,a){this.options[b]=a;"disabled"===b&&this.widget()[a?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
a);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(a,d,c){var h,i=this.options[a],c=c||{},d=b.Event(d);d.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d.target=this.element[0];if(a=d.originalEvent)for(h in a)h in d||(d[h]=a[h]);this.element.trigger(d,c);return!(b.isFunction(i)&&!1===i.call(this.element[0],d,c)||d.isDefaultPrevented())}}})(jQuery);
(function(b){var a=!1;b(document).mouseup(function(){a=!1});b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+this.widgetName,function(d){if(!0===b.data(d.target,a.widgetName+".preventClickEvent"))return b.removeData(d.target,a.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(c){if(!a){this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var d=this,e=1==c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?b(c.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(c))return!0;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(c),
!this._mouseStarted))return c.preventDefault(),!0;!0===b.data(c.target,this.widgetName+".preventClickEvent")&&b.removeData(c.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(b){return d._mouseMove(b)};this._mouseUpDelegate=function(b){return d._mouseUp(b)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);c.preventDefault();return a=!0}},_mouseMove:function(a){if(b.browser.msie&&!(9<=document.documentMode)&&
!a.button)return this._mouseUp(a);if(this._mouseStarted)return this._mouseDrag(a),a.preventDefault();this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,a),this._mouseStarted?this._mouseDrag(a):this._mouseUp(a));return!this._mouseStarted},_mouseUp:function(a){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,a.target==
this._mouseDownEvent.target&&b.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a));return!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(b){b.ui=b.ui||{};var a=/left|center|right/,c=/top|center|bottom/,d,e=b.fn.position,f=b.fn.offset;b.fn.position=function(f){if(!f||!f.of)return e.apply(this,arguments);var f=b.extend({},f),h=b(f.of),i=h[0],j=(f.collision||"flip").split(" "),l=f.offset?f.offset.split(" "):[0,0],k,n,m;9===i.nodeType?(k=h.width(),n=h.height(),m={top:0,left:0}):i.setTimeout?(k=h.width(),n=h.height(),m={top:h.scrollTop(),left:h.scrollLeft()}):i.preventDefault?(f.at="left top",k=n=0,m={top:f.of.pageY,left:f.of.pageX}):
(k=h.outerWidth(),n=h.outerHeight(),m=h.offset());b.each(["my","at"],function(){var b=(f[this]||"").split(" ");1===b.length&&(b=a.test(b[0])?b.concat(["center"]):c.test(b[0])?["center"].concat(b):["center","center"]);b[0]=a.test(b[0])?b[0]:"center";b[1]=c.test(b[1])?b[1]:"center";f[this]=b});1===j.length&&(j[1]=j[0]);l[0]=parseInt(l[0],10)||0;1===l.length&&(l[1]=l[0]);l[1]=parseInt(l[1],10)||0;"right"===f.at[0]?m.left+=k:"center"===f.at[0]&&(m.left+=k/2);"bottom"===f.at[1]?m.top+=n:"center"===f.at[1]&&
(m.top+=n/2);m.left+=l[0];m.top+=l[1];return this.each(function(){var a=b(this),c=a.outerWidth(),e=a.outerHeight(),h=parseInt(b.curCSS(this,"marginLeft",!0))||0,i=parseInt(b.curCSS(this,"marginTop",!0))||0,q=c+h+(parseInt(b.curCSS(this,"marginRight",!0))||0),v=e+i+(parseInt(b.curCSS(this,"marginBottom",!0))||0),t=b.extend({},m),w;"right"===f.my[0]?t.left-=c:"center"===f.my[0]&&(t.left-=c/2);"bottom"===f.my[1]?t.top-=e:"center"===f.my[1]&&(t.top-=e/2);d||(t.left=Math.round(t.left),t.top=Math.round(t.top));
w={left:t.left-h,top:t.top-i};b.each(["left","top"],function(a,d){b.ui.position[j[a]]&&b.ui.position[j[a]][d](t,{targetWidth:k,targetHeight:n,elemWidth:c,elemHeight:e,collisionPosition:w,collisionWidth:q,collisionHeight:v,offset:l,my:f.my,at:f.at})});b.fn.bgiframe&&a.bgiframe();a.offset(b.extend(t,{using:f.using}))})};b.ui.position={fit:{left:function(a,d){var c=b(window),c=d.collisionPosition.left+d.collisionWidth-c.width()-c.scrollLeft();a.left=0<c?a.left-c:Math.max(a.left-d.collisionPosition.left,
a.left)},top:function(a,d){var c=b(window),c=d.collisionPosition.top+d.collisionHeight-c.height()-c.scrollTop();a.top=0<c?a.top-c:Math.max(a.top-d.collisionPosition.top,a.top)}},flip:{left:function(a,d){if("center"!==d.at[0]){var c=b(window),c=d.collisionPosition.left+d.collisionWidth-c.width()-c.scrollLeft(),e="left"===d.my[0]?-d.elemWidth:"right"===d.my[0]?d.elemWidth:0,f="left"===d.at[0]?d.targetWidth:-d.targetWidth,k=-2*d.offset[0];a.left+=0>d.collisionPosition.left?e+f+k:0<c?e+f+k:0}},top:function(a,
d){if("center"!==d.at[1]){var c=b(window),c=d.collisionPosition.top+d.collisionHeight-c.height()-c.scrollTop(),e="top"===d.my[1]?-d.elemHeight:"bottom"===d.my[1]?d.elemHeight:0,f="top"===d.at[1]?d.targetHeight:-d.targetHeight,k=-2*d.offset[1];a.top+=0>d.collisionPosition.top?e+f+k:0<c?e+f+k:0}}}};b.offset.setOffset||(b.offset.setOffset=function(a,d){/static/.test(b.curCSS(a,"position"))&&(a.style.position="relative");var c=b(a),e=c.offset(),f=parseInt(b.curCSS(a,"top",!0),10)||0,k=parseInt(b.curCSS(a,
"left",!0),10)||0,e={top:d.top-e.top+f,left:d.left-e.left+k};"using"in d?d.using.call(a,e):c.css(e)},b.fn.offset=function(a){var d=this[0];return!d||!d.ownerDocument?null:a?this.each(function(){b.offset.setOffset(this,a)}):f.call(this)});(function(){var a=document.getElementsByTagName("body")[0],c=document.createElement("div"),e,f;e=document.createElement(a?"div":"body");f={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};a&&b.extend(f,{position:"absolute",left:"-1000px",
top:"-1000px"});for(var l in f)e.style[l]=f[l];e.appendChild(c);f=a||document.documentElement;f.insertBefore(e,f.firstChild);c.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";c=b(c).offset(function(b,a){return a}).offset();e.innerHTML="";f.removeChild(e);a=c.top+c.left+(a?2E3:0);d=21<a&&22>a})()})(jQuery);
(function(b){b.widget("ui.draggable",b.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(a){var c=this.options;if(this.helper||c.disabled||b(a.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(a);if(!this.handle)return!1;c.iframeFix&&b(!0===c.iframeFix?"iframe":c.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(b(this).offset()).appendTo("body")});return!0},_mouseStart:function(a){var c=this.options;this.helper=this._createHelper(a);this._cacheHelperProportions();b.ui.ddmanager&&(b.ui.ddmanager.current=
this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};b.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;
this.originalPageY=a.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);c.containment&&this._setContainment();if(!1===this._trigger("start",a))return this._clear(),!1;this._cacheHelperProportions();b.ui.ddmanager&&!c.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,!0);b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,a);return!0},_mouseDrag:function(a,c){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");
if(!c){var d=this._uiHash();if(!1===this._trigger("drag",a,d))return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";b.ui.ddmanager&&b.ui.ddmanager.drag(this,a);return!1},_mouseStop:function(a){var c=!1;b.ui.ddmanager&&!this.options.dropBehaviour&&(c=b.ui.ddmanager.drop(this,a));this.dropped&&(c=this.dropped,this.dropped=
!1);if((!this.element[0]||!this.element[0].parentNode)&&"original"==this.options.helper)return!1;if("invalid"==this.options.revert&&!c||"valid"==this.options.revert&&c||!0===this.options.revert||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var d=this;b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==d._trigger("stop",a)&&d._clear()})}else!1!==this._trigger("stop",a)&&this._clear();return!1},_mouseUp:function(a){!0===
this.options.iframeFix&&b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,a);return b.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var c=!this.options.handle||!b(this.options.handle,this.element).length?!0:!1;b(this.options.handle,this.element).find("*").andSelf().each(function(){this==a.target&&(c=
!0)});return c},_createHelper:function(a){var c=this.options,a=b.isFunction(c.helper)?b(c.helper.apply(this.element[0],[a])):"clone"==c.helper?this.element.clone().removeAttr("id"):this.element;a.parents("body").length||a.appendTo("parent"==c.appendTo?this.element[0].parentNode:c.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));b.isArray(a)&&(a={left:+a[0],top:+a[1]||
0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],
this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&b.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var b=this.element.position();return{top:b.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=["document"==a.containment?0:b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==a.containment?0:b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==a.containment?0:b(window).scrollLeft())+b("document"==a.containment?document:
window).width()-this.helperProportions.width-this.margins.left,("document"==a.containment?0:b(window).scrollTop())+(b("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var a=b(a.containment),c=a[0];if(c){a.offset();var d="hidden"!=b(c).css("overflow");this.containment=[(parseInt(b(c).css("borderLeftWidth"),10)||0)+(parseInt(b(c).css("paddingLeft"),
10)||0),(parseInt(b(c).css("borderTopWidth"),10)||0)+(parseInt(b(c).css("paddingTop"),10)||0),(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(b(c).css("borderLeftWidth"),10)||0)-(parseInt(b(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(b(c).css("borderTopWidth"),10)||0)-(parseInt(b(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];
this.relative_container=a}}else a.containment.constructor==Array&&(this.containment=a.containment)},_convertPositionTo:function(a,c){c||(c=this.position);var d="absolute"==a?1:-1,e="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?
0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d)}},_generatePosition:function(a){var c=this.options,d="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,
e=/(html|body)/i.test(d[0].tagName),f=a.pageX,g=a.pageY;if(this.originalPosition){var h;this.containment&&(this.relative_container?(h=this.relative_container.offset(),h=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+h.left,this.containment[3]+h.top]):h=this.containment,a.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),a.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),a.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),
a.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top));c.grid&&(g=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY,g=h?g-this.offset.click.top<h[1]||g-this.offset.click.top>h[3]?g-this.offset.click.top<h[1]?g+c.grid[1]:g-c.grid[1]:g:g,f=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX,f=h?f-this.offset.click.left<h[0]||f-this.offset.click.left>h[2]?f-this.offset.click.left<h[0]?
f+c.grid[0]:f-c.grid[0]:f:f)}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(a,c,d){d=d||this._uiHash();b.ui.plugin.call(this,a,[c,d]);"drag"==a&&(this.positionAbs=this._convertPositionTo("absolute"));return b.Widget.prototype._trigger.call(this,a,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});b.extend(b.ui.draggable,{version:"1.8.18"});
b.ui.plugin.add("draggable","connectToSortable",{start:function(a,c){var d=b(this).data("draggable"),e=d.options,f=b.extend({},c,{item:d.element});d.sortables=[];b(e.connectToSortable).each(function(){var c=b.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",a,f))})},stop:function(a,c){var d=b(this).data("draggable"),e=b.extend({},c,{item:d.element});b.each(d.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,"original"==d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,e))})},drag:function(a,c){var d=b(this).data("draggable"),e=this;b.each(d.sortables,function(){this.instance.positionAbs=
d.positionAbs;this.instance.helperProportions=d.helperProportions;this.instance.offset.click=d.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=b(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},a.target=this.instance.currentItem[0],this.instance._mouseCapture(a,
!0),this.instance._mouseStart(a,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",a),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(a)):this.instance.isOver&&
(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",a),d.dropped=!1)})}});b.ui.plugin.add("draggable","cursor",{start:function(){var a=b("body"),c=b(this).data("draggable").options;
a.css("cursor")&&(c._cursor=a.css("cursor"));a.css("cursor",c.cursor)},stop:function(){var a=b(this).data("draggable").options;a._cursor&&b("body").css("cursor",a._cursor)}});b.ui.plugin.add("draggable","opacity",{start:function(a,c){var d=b(c.helper),e=b(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity"));d.css("opacity",e.opacity)},stop:function(a,c){var d=b(this).data("draggable").options;d._opacity&&b(c.helper).css("opacity",d._opacity)}});b.ui.plugin.add("draggable",
"scroll",{start:function(){var a=b(this).data("draggable");a.scrollParent[0]!=document&&"HTML"!=a.scrollParent[0].tagName&&(a.overflowOffset=a.scrollParent.offset())},drag:function(a){var c=b(this).data("draggable"),d=c.options,e=!1;if(c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName){if(!d.axis||"x"!=d.axis)c.overflowOffset.top+c.scrollParent[0].offsetHeight-a.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:a.pageY-c.overflowOffset.top<
d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed);if(!d.axis||"y"!=d.axis)c.overflowOffset.left+c.scrollParent[0].offsetWidth-a.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:a.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed)}else{if(!d.axis||"x"!=d.axis)a.pageY-b(document).scrollTop()<d.scrollSensitivity?e=b(document).scrollTop(b(document).scrollTop()-
d.scrollSpeed):b(window).height()-(a.pageY-b(document).scrollTop())<d.scrollSensitivity&&(e=b(document).scrollTop(b(document).scrollTop()+d.scrollSpeed));if(!d.axis||"y"!=d.axis)a.pageX-b(document).scrollLeft()<d.scrollSensitivity?e=b(document).scrollLeft(b(document).scrollLeft()-d.scrollSpeed):b(window).width()-(a.pageX-b(document).scrollLeft())<d.scrollSensitivity&&(e=b(document).scrollLeft(b(document).scrollLeft()+d.scrollSpeed))}!1!==e&&b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(c,
a)}});b.ui.plugin.add("draggable","snap",{start:function(){var a=b(this).data("draggable"),c=a.options;a.snapElements=[];b(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var d=b(this),c=d.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:d.outerWidth(),height:d.outerHeight(),top:c.top,left:c.left})})},drag:function(a,c){for(var d=b(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,
j=i+d.helperProportions.height,l=d.snapElements.length-1;0<=l;l--){var k=d.snapElements[l].left,n=k+d.snapElements[l].width,m=d.snapElements[l].top,p=m+d.snapElements[l].height;if(k-f<g&&g<n+f&&m-f<i&&i<p+f||k-f<g&&g<n+f&&m-f<j&&j<p+f||k-f<h&&h<n+f&&m-f<i&&i<p+f||k-f<h&&h<n+f&&m-f<j&&j<p+f){if("inner"!=e.snapMode){var o=Math.abs(m-j)<=f,u=Math.abs(p-i)<=f,r=Math.abs(k-h)<=f,s=Math.abs(n-g)<=f;o&&(c.position.top=d._convertPositionTo("relative",{top:m-d.helperProportions.height,left:0}).top-d.margins.top);
u&&(c.position.top=d._convertPositionTo("relative",{top:p,left:0}).top-d.margins.top);r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:k-d.helperProportions.width}).left-d.margins.left);s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:n}).left-d.margins.left)}var q=o||u||r||s;"outer"!=e.snapMode&&(o=Math.abs(m-i)<=f,u=Math.abs(p-j)<=f,r=Math.abs(k-g)<=f,s=Math.abs(n-h)<=f,o&&(c.position.top=d._convertPositionTo("relative",{top:m,left:0}).top-d.margins.top),u&&(c.position.top=
d._convertPositionTo("relative",{top:p-d.helperProportions.height,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:k}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:n-d.helperProportions.width}).left-d.margins.left));!d.snapElements[l].snapping&&(o||u||r||s||q)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,a,b.extend(d._uiHash(),{snapItem:d.snapElements[l].item}));d.snapElements[l].snapping=o||u||r||s||q}else d.snapElements[l].snapping&&
d.options.snap.release&&d.options.snap.release.call(d.element,a,b.extend(d._uiHash(),{snapItem:d.snapElements[l].item})),d.snapElements[l].snapping=!1}}});b.ui.plugin.add("draggable","stack",{start:function(){var a=b(this).data("draggable").options,a=b.makeArray(b(a.stack)).sort(function(a,c){return(parseInt(b(a).css("zIndex"),10)||0)-(parseInt(b(c).css("zIndex"),10)||0)});if(a.length){var c=parseInt(a[0].style.zIndex)||0;b(a).each(function(b){this.style.zIndex=c+b});this[0].style.zIndex=c+a.length}}});
b.ui.plugin.add("draggable","zIndex",{start:function(a,c){var d=b(c.helper),e=b(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex"));d.css("zIndex",e.zIndex)},stop:function(a,c){var d=b(this).data("draggable").options;d._zIndex&&b(c.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(b){b.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var a=this.options,c=a.accept;this.isover=0;this.isout=1;this.accept=b.isFunction(c)?c:function(b){return b.is(c)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};b.ui.ddmanager.droppables[a.scope]=b.ui.ddmanager.droppables[a.scope]||[];b.ui.ddmanager.droppables[a.scope].push(this);
a.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var a=b.ui.ddmanager.droppables[this.options.scope],c=0;c<a.length;c++)a[c]==this&&a.splice(c,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(a,c){"accept"==a&&(this.accept=b.isFunction(c)?c:function(b){return b.is(c)});b.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var c=b.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);c&&this._trigger("activate",a,this.ui(c))},_deactivate:function(a){var c=b.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);c&&this._trigger("deactivate",a,this.ui(c))},_over:function(a){var c=b.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",
a,this.ui(c)))},_out:function(a){var c=b.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",a,this.ui(c)))},_drop:function(a,c){var d=c||b.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var a=b.data(this,
"droppable");if(a.options.greedy&&!a.options.disabled&&a.options.scope==d.options.scope&&a.accept.call(a.element[0],d.currentItem||d.element)&&b.ui.intersect(d,b.extend(a,{offset:a.element.offset()}),a.options.tolerance))return e=!0,!1});return e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",a,this.ui(d)),this.element):
!1},ui:function(b){return{draggable:b.currentItem||b.element,helper:b.helper,position:b.position,offset:b.positionAbs}}});b.extend(b.ui.droppable,{version:"1.8.18"});b.ui.intersect=function(a,c,d){if(!c.offset)return!1;var e=(a.positionAbs||a.position.absolute).left,f=e+a.helperProportions.width,g=(a.positionAbs||a.position.absolute).top,h=g+a.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,l=c.offset.top,k=l+c.proportions.height;switch(d){case "fit":return i<=e&&f<=j&&l<=g&&h<=k;
case "intersect":return i<e+a.helperProportions.width/2&&f-a.helperProportions.width/2<j&&l<g+a.helperProportions.height/2&&h-a.helperProportions.height/2<k;case "pointer":return b.ui.isOver((a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,l,i,c.proportions.height,c.proportions.width);case "touch":return(g>=l&&g<=k||h>=l&&h<=k||g<l&&h>k)&&(e>=i&&e<=j||f>=i&&f<=j||e<i&&f>j);default:return!1}};
b.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,c){var d=b.ui.ddmanager.droppables[a.options.scope]||[],e=c?c.type:null,f=(a.currentItem||a.element).find(":data(droppable)").andSelf(),g=0;a:for(;g<d.length;g++)if(!(d[g].options.disabled||a&&!d[g].accept.call(d[g].element[0],a.currentItem||a.element))){for(var h=0;h<f.length;h++)if(f[h]==d[g].element[0]){d[g].proportions.height=0;continue a}d[g].visible="none"!=d[g].element.css("display");d[g].visible&&("mousedown"==
e&&d[g]._activate.call(d[g],c),d[g].offset=d[g].element.offset(),d[g].proportions={width:d[g].element[0].offsetWidth,height:d[g].element[0].offsetHeight})}},drop:function(a,c){var d=!1;b.each(b.ui.ddmanager.droppables[a.options.scope]||[],function(){!this.options||(!this.options.disabled&&this.visible&&b.ui.intersect(a,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||a.element)&&(this.isout=1,this.isover=
0,this._deactivate.call(this,c)))});return d},dragStart:function(a,c){a.element.parents(":not(body,html)").bind("scroll.droppable",function(){a.options.refreshPositions||b.ui.ddmanager.prepareOffsets(a,c)})},drag:function(a,c){a.options.refreshPositions&&b.ui.ddmanager.prepareOffsets(a,c);b.each(b.ui.ddmanager.droppables[a.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d=b.ui.intersect(a,this,this.options.tolerance);if(d=!d&&1==this.isover?"isout":d&&
0==this.isover?"isover":null){var e;if(this.options.greedy){var f=this.element.parents(":data(droppable):eq(0)");f.length&&(e=b.data(f[0],"droppable"),e.greedyChild="isover"==d?1:0)}e&&"isover"==d&&(e.isover=0,e.isout=1,e._out.call(e,c));this[d]=1;this["isout"==d?"isover":"isout"]=0;this["isover"==d?"_over":"_out"].call(this,c);e&&"isout"==d&&(e.isout=0,e.isover=1,e._over.call(e,c))}}})},dragStop:function(a,c){a.element.parents(":not(body,html)").unbind("scroll.droppable");a.options.refreshPositions||
b.ui.ddmanager.prepareOffsets(a,c)}}})(jQuery);
(function(b){b.widget("ui.resizable",b.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var a=this,c=this.options;this.element.addClass("ui-resizable");b.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],
_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(b('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=
!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,
display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=c.handles||(b(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var f=this.handles.split(",");this.handles=
{};for(var g=0;g<f.length;g++){var h=b.trim(f[g]),i=b('<div class="ui-resizable-handle ui-resizable-'+h+'"></div>');/sw|se|ne|nw/.test(h)&&i.css({zIndex:++c.zIndex});"se"==h&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[h]=".ui-resizable-"+h;this.element.append(i)}}this._renderAxis=function(a){var a=a||this.element,d;for(d in this.handles){this.handles[d].constructor==String&&(this.handles[d]=b(this.handles[d],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var c=
b(this.handles[d],this.element),e=0,e=/sw|ne|nw|se|n|s/.test(d)?c.outerHeight():c.outerWidth(),c=["padding",/ne|nw|n/.test(d)?"Top":/se|sw|s/.test(d)?"Bottom":/^e$/.test(d)?"Right":"Left"].join("");a.css(c,e);this._proportionallyResize()}b(this.handles[d])}};this._renderAxis(this.element);this._handles=b(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!a.resizing){if(this.className)var b=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);a.axis=
b&&b[1]?b[1]:"se"}});c.autoHide&&(this._handles.hide(),b(this.element).addClass("ui-resizable-autohide").hover(function(){c.disabled||(b(this).removeClass("ui-resizable-autohide"),a._handles.show())},function(){c.disabled||a.resizing||(b(this).addClass("ui-resizable-autohide"),a._handles.hide())}));this._mouseInit()},destroy:function(){this._mouseDestroy();var a=function(a){b(a).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){a(this.element);var c=this.element;c.after(this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);a(this.originalElement);return this},_mouseCapture:function(a){var c=!1,f;for(f in this.handles)b(this.handles[f])[0]==a.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(d){var c=this.options,f=this.element.position(),
g=this.element;this.resizing=!0;this.documentScroll={top:b(document).scrollTop(),left:b(document).scrollLeft()};(g.is(".ui-draggable")||/absolute/.test(g.css("position")))&&g.css({position:"absolute",top:f.top,left:f.left});this._renderProxy();var f=a(this.helper.css("left")),h=a(this.helper.css("top"));c.containment&&(f+=b(c.containment).scrollLeft()||0,h+=b(c.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:f,top:h};this.size=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:
{width:g.width(),height:g.height()};this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()};this.originalPosition={left:f,top:h};this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()};this.originalMousePosition={left:d.pageX,top:d.pageY};this.aspectRatio="number"==typeof c.aspectRatio?c.aspectRatio:this.originalSize.width/this.originalSize.height||1;c=b(".ui-resizable-"+this.axis).css("cursor");b("body").css("cursor",
"auto"==c?this.axis+"-resize":c);g.addClass("ui-resizable-resizing");this._propagate("start",d);return!0},_mouseDrag:function(b){var a=this.helper,c=this.originalMousePosition,g=this._change[this.axis];if(!g)return!1;c=g.apply(this,[b,b.pageX-c.left||0,b.pageY-c.top||0]);this._updateVirtualBoundaries(b.shiftKey);if(this._aspectRatio||b.shiftKey)c=this._updateRatio(c,b);c=this._respectSize(c,b);this._propagate("resize",b);a.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+
"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",b,this.ui());return!1},_mouseStop:function(a){this.resizing=!1;var c=this.options;if(this._helper){var f=this._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),f=g&&b.ui.hasScroll(f[0],"left")?0:this.sizeDiff.height,g=g?0:this.sizeDiff.width,g={width:this.helper.width()-g,height:this.helper.height()-f},f=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,h=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;c.animate||this.element.css(b.extend(g,{top:h,left:f}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!c.animate&&this._proportionallyResize()}b("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",a);this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(b){var a=
this.options,f,g,h,a={minWidth:c(a.minWidth)?a.minWidth:0,maxWidth:c(a.maxWidth)?a.maxWidth:Infinity,minHeight:c(a.minHeight)?a.minHeight:0,maxHeight:c(a.maxHeight)?a.maxHeight:Infinity};if(this._aspectRatio||b)b=a.minHeight*this.aspectRatio,g=a.minWidth/this.aspectRatio,f=a.maxHeight*this.aspectRatio,h=a.maxWidth/this.aspectRatio,b>a.minWidth&&(a.minWidth=b),g>a.minHeight&&(a.minHeight=g),f<a.maxWidth&&(a.maxWidth=f),h<a.maxHeight&&(a.maxHeight=h);this._vBoundaries=a},_updateCache:function(b){this.offset=
this.helper.offset();c(b.left)&&(this.position.left=b.left);c(b.top)&&(this.position.top=b.top);c(b.height)&&(this.size.height=b.height);c(b.width)&&(this.size.width=b.width)},_updateRatio:function(b){var a=this.position,f=this.size,g=this.axis;c(b.height)?b.width=b.height*this.aspectRatio:c(b.width)&&(b.height=b.width/this.aspectRatio);"sw"==g&&(b.left=a.left+(f.width-b.width),b.top=null);"nw"==g&&(b.top=a.top+(f.height-b.height),b.left=a.left+(f.width-b.width));return b},_respectSize:function(b){var a=
this._vBoundaries,f=this.axis,g=c(b.width)&&a.maxWidth&&a.maxWidth<b.width,h=c(b.height)&&a.maxHeight&&a.maxHeight<b.height,i=c(b.width)&&a.minWidth&&a.minWidth>b.width,j=c(b.height)&&a.minHeight&&a.minHeight>b.height;i&&(b.width=a.minWidth);j&&(b.height=a.minHeight);g&&(b.width=a.maxWidth);h&&(b.height=a.maxHeight);var l=this.originalPosition.left+this.originalSize.width,k=this.position.top+this.size.height,n=/sw|nw|w/.test(f),f=/nw|ne|n/.test(f);i&&n&&(b.left=l-a.minWidth);g&&n&&(b.left=l-a.maxWidth);
j&&f&&(b.top=k-a.minHeight);h&&f&&(b.top=k-a.maxHeight);(a=!b.width&&!b.height)&&!b.left&&b.top?b.top=null:a&&!b.top&&b.left&&(b.left=null);return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a=this.helper||this.element,c=0;c<this._proportionallyResizeElements.length;c++){var f=this._proportionallyResizeElements[c];if(!this.borderDif){var g=[f.css("borderTopWidth"),f.css("borderRightWidth"),f.css("borderBottomWidth"),f.css("borderLeftWidth")],h=[f.css("paddingTop"),
f.css("paddingRight"),f.css("paddingBottom"),f.css("paddingLeft")];this.borderDif=b.map(g,function(b,a){var c=parseInt(b,10)||0,d=parseInt(h[a],10)||0;return c+d})}if(!b.browser.msie||!b(a).is(":hidden")&&!b(a).parents(":hidden").length)f.css({height:a.height()-this.borderDif[0]-this.borderDif[2]||0,width:a.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var a=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||b('<div style="overflow:hidden;"></div>');
var c=b.browser.msie&&7>b.browser.version,f=c?1:0,c=c?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+c,height:this.element.outerHeight()+c,position:"absolute",left:this.elementOffset.left-f+"px",top:this.elementOffset.top-f+"px",zIndex:++a.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,a){return{width:this.originalSize.width+a}},w:function(b,a){return{left:this.originalPosition.left+a,width:this.originalSize.width-
a}},n:function(b,a,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(b,a,c){return{height:this.originalSize.height+c}},se:function(a,c,f){return b.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[a,c,f]))},sw:function(a,c,f){return b.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[a,c,f]))},ne:function(a,c,f){return b.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[a,c,f]))},nw:function(a,c,
f){return b.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[a,c,f]))}},_propagate:function(a,c){b.ui.plugin.call(this,a,[c,this.ui()]);"resize"!=a&&this._trigger(a,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});b.extend(b.ui.resizable,{version:"1.8.18"});b.ui.plugin.add("resizable","alsoResize",
{start:function(){var a=b(this).data("resizable").options,c=function(a){b(a).each(function(){var a=b(this);a.data("resizable-alsoresize",{width:parseInt(a.width(),10),height:parseInt(a.height(),10),left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10)})})};"object"==typeof a.alsoResize&&!a.alsoResize.parentNode?a.alsoResize.length?(a.alsoResize=a.alsoResize[0],c(a.alsoResize)):b.each(a.alsoResize,function(b){c(b)}):c(a.alsoResize)},resize:function(a,c){var f=b(this).data("resizable"),g=f.options,
h=f.originalSize,i=f.originalPosition,j={height:f.size.height-h.height||0,width:f.size.width-h.width||0,top:f.position.top-i.top||0,left:f.position.left-i.left||0},l=function(a,d){b(a).each(function(){var a=b(this),f=b(this).data("resizable-alsoresize"),g={},h=d&&d.length?d:a.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];b.each(h,function(b,a){var c=(f[a]||0)+(j[a]||0);c&&0<=c&&(g[a]=c||null)});a.css(g)})};"object"==typeof g.alsoResize&&!g.alsoResize.nodeType?
b.each(g.alsoResize,function(b,a){l(b,a)}):l(g.alsoResize)},stop:function(){b(this).removeData("resizable-alsoresize")}});b.ui.plugin.add("resizable","animate",{stop:function(a){var c=b(this).data("resizable"),f=c.options,g=c._proportionallyResizeElements,h=g.length&&/textarea/i.test(g[0].nodeName),i=h&&b.ui.hasScroll(g[0],"left")?0:c.sizeDiff.height,h={width:c.size.width-(h?0:c.sizeDiff.width),height:c.size.height-i},i=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||
null,j=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(b.extend(h,j&&i?{top:j,left:i}:{}),{duration:f.animateDuration,easing:f.animateEasing,step:function(){var f={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};g&&g.length&&b(g[0]).css({width:f.width,height:f.height});c._updateCache(f);c._propagate("resize",a)}})}});b.ui.plugin.add("resizable",
"containment",{start:function(){var c=b(this).data("resizable"),e=c.element,f=c.options.containment;if(e=f instanceof b?f.get(0):/parent/.test(f)?e.parent().get(0):f)if(c.containerElement=b(e),/document/.test(f)||f==document)c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:b(document),left:0,top:0,width:b(document).width(),height:b(document).height()||document.body.parentNode.scrollHeight};else{var g=b(e),h=[];b(["Top","Right","Left","Bottom"]).each(function(b,
c){h[b]=a(g.css("padding"+c))});c.containerOffset=g.offset();c.containerPosition=g.position();c.containerSize={height:g.innerHeight()-h[3],width:g.innerWidth()-h[1]};var f=c.containerOffset,i=c.containerSize.height,j=c.containerSize.width,j=b.ui.hasScroll(e,"left")?e.scrollWidth:j,i=b.ui.hasScroll(e)?e.scrollHeight:i;c.parentData={element:e,left:f.left,top:f.top,width:j,height:i}}},resize:function(a){var c=b(this).data("resizable"),f=c.options,g=c.containerOffset,h=c.position,a=c._aspectRatio||a.shiftKey,
i={top:0,left:0},j=c.containerElement;j[0]!=document&&/static/.test(j.css("position"))&&(i=g);h.left<(c._helper?g.left:0)&&(c.size.width+=c._helper?c.position.left-g.left:c.position.left-i.left,a&&(c.size.height=c.size.width/f.aspectRatio),c.position.left=f.helper?g.left:0);h.top<(c._helper?g.top:0)&&(c.size.height+=c._helper?c.position.top-g.top:c.position.top,a&&(c.size.width=c.size.height*f.aspectRatio),c.position.top=c._helper?g.top:0);c.offset.left=c.parentData.left+c.position.left;c.offset.top=
c.parentData.top+c.position.top;f=Math.abs(c.offset.left-i.left+c.sizeDiff.width);g=Math.abs((c._helper?c.offset.top-i.top:c.offset.top-g.top)+c.sizeDiff.height);h=c.containerElement.get(0)==c.element.parent().get(0);i=/relative|absolute/.test(c.containerElement.css("position"));h&&i&&(f-=c.parentData.left);f+c.size.width>=c.parentData.width&&(c.size.width=c.parentData.width-f,a&&(c.size.height=c.size.width/c.aspectRatio));g+c.size.height>=c.parentData.height&&(c.size.height=c.parentData.height-g,
a&&(c.size.width=c.size.height*c.aspectRatio))},stop:function(){var a=b(this).data("resizable"),c=a.options,f=a.containerOffset,g=a.containerPosition,h=a.containerElement,i=b(a.helper),j=i.offset(),l=i.outerWidth()-a.sizeDiff.width,i=i.outerHeight()-a.sizeDiff.height;a._helper&&!c.animate&&/relative/.test(h.css("position"))&&b(this).css({left:j.left-g.left-f.left,width:l,height:i});a._helper&&!c.animate&&/static/.test(h.css("position"))&&b(this).css({left:j.left-g.left-f.left,width:l,height:i})}});
b.ui.plugin.add("resizable","ghost",{start:function(){var a=b(this).data("resizable"),c=a.options,f=a.size;a.ghost=a.originalElement.clone();a.ghost.css({opacity:0.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:"");a.ghost.appendTo(a.helper)},resize:function(){var a=b(this).data("resizable");a.ghost&&a.ghost.css({position:"relative",height:a.size.height,width:a.size.width})},stop:function(){var a=
b(this).data("resizable");a.ghost&&a.helper&&a.helper.get(0).removeChild(a.ghost.get(0))}});b.ui.plugin.add("resizable","grid",{resize:function(){var a=b(this).data("resizable"),c=a.options,f=a.size,g=a.originalSize,h=a.originalPosition,i=a.axis;c.grid="number"==typeof c.grid?[c.grid,c.grid]:c.grid;var j=Math.round((f.width-g.width)/(c.grid[0]||1))*(c.grid[0]||1),c=Math.round((f.height-g.height)/(c.grid[1]||1))*(c.grid[1]||1);/^(se|s|e)$/.test(i)?(a.size.width=g.width+j,a.size.height=g.height+c):
/^(ne)$/.test(i)?(a.size.width=g.width+j,a.size.height=g.height+c,a.position.top=h.top-c):/^(sw)$/.test(i)?(a.size.width=g.width+j,a.size.height=g.height+c,a.position.left=h.left-j):(a.size.width=g.width+j,a.size.height=g.height+c,a.position.top=h.top-c,a.position.left=h.left-j)}});var a=function(b){return parseInt(b,10)||0},c=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
(function(b){b.widget("ui.selectable",b.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var a=this;this.element.addClass("ui-selectable");this.dragged=!1;var c;this.refresh=function(){c=b(a.options.filter,a.element[0]);c.addClass("ui-selectee");c.each(function(){var a=b(this),c=a.offset();b.data(this,"selectable-item",{element:this,$element:a,left:c.left,top:c.top,right:c.left+a.outerWidth(),bottom:c.top+a.outerHeight(),startselected:!1,
selected:a.hasClass("ui-selected"),selecting:a.hasClass("ui-selecting"),unselecting:a.hasClass("ui-unselecting")})})};this.refresh();this.selectees=c.addClass("ui-selectee");this._mouseInit();this.helper=b("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(a){var c=
this;this.opos=[a.pageX,a.pageY];if(!this.options.disabled){var d=this.options;this.selectees=b(d.filter,this.element[0]);this._trigger("start",a);b(d.appendTo).append(this.helper);this.helper.css({left:a.clientX,top:a.clientY,width:0,height:0});d.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var d=b.data(this,"selectable-item");d.startselected=!0;!a.metaKey&&!a.ctrlKey&&(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),
d.unselecting=!0,c._trigger("unselecting",a,{unselecting:d.element}))});b(a.target).parents().andSelf().each(function(){var d=b.data(this,"selectable-item");if(d){var f=!a.metaKey&&!a.ctrlKey||!d.$element.hasClass("ui-selected");d.$element.removeClass(f?"ui-unselecting":"ui-selected").addClass(f?"ui-selecting":"ui-unselecting");d.unselecting=!f;d.selecting=f;(d.selected=f)?c._trigger("selecting",a,{selecting:d.element}):c._trigger("unselecting",a,{unselecting:d.element});return!1}})}},_mouseDrag:function(a){var c=
this;this.dragged=!0;if(!this.options.disabled){var d=this.options,e=this.opos[0],f=this.opos[1],g=a.pageX,h=a.pageY;if(e>g)var i=g,g=e,e=i;f>h&&(i=h,h=f,f=i);this.helper.css({left:e,top:f,width:g-e,height:h-f});this.selectees.each(function(){var i=b.data(this,"selectable-item");if(i&&i.element!=c.element[0]){var l=false;d.tolerance=="touch"?l=!(i.left>g||i.right<e||i.top>h||i.bottom<f):d.tolerance=="fit"&&(l=i.left>e&&i.right<g&&i.top>f&&i.bottom<h);l?(i.selected&&(i.$element.removeClass("ui-selected"),
i.selected=false),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=false),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=true,c._trigger("selecting",a,{selecting:i.element}))):(i.selecting&&((a.metaKey||a.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=false,i.$element.addClass("ui-selected"),i.selected=true):(i.$element.removeClass("ui-selecting"),i.selecting=false,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=
true),c._trigger("unselecting",a,{unselecting:i.element}))),i.selected&&!a.metaKey&&!a.ctrlKey&&!i.startselected&&(i.$element.removeClass("ui-selected"),i.selected=false,i.$element.addClass("ui-unselecting"),i.unselecting=true,c._trigger("unselecting",a,{unselecting:i.element})))}});return!1}},_mouseStop:function(a){var c=this;this.dragged=!1;b(".ui-unselecting",this.element[0]).each(function(){var d=b.data(this,"selectable-item");d.$element.removeClass("ui-unselecting");d.unselecting=!1;d.startselected=
!1;c._trigger("unselected",a,{unselected:d.element})});b(".ui-selecting",this.element[0]).each(function(){var d=b.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected");d.selecting=!1;d.selected=!0;d.startselected=!0;c._trigger("selected",a,{selected:d.element})});this._trigger("stop",a);this.helper.remove();return!1}});b.extend(b.ui.selectable,{version:"1.8.18"})})(jQuery);
(function(b){b.widget("ui.sortable",b.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var b=this.options;this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?"x"===b.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},destroy:function(){b.Widget.prototype.destroy.call(this);this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(a,
c){"disabled"===a?(this.options[a]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):b.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,c){var d=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(a);var e=null,f=this;b(a.target).parents().each(function(){if(b.data(this,d.widgetName+"-item")==f)return e=b(this),!1});b.data(a.target,d.widgetName+"-item")==f&&(e=b(a.target));if(!e)return!1;if(this.options.handle&&
!c){var g=!1;b(this.options.handle,e).find("*").andSelf().each(function(){this==a.target&&(g=!0)});if(!g)return!1}this.currentItem=e;this._removeCurrentsFromItems();return!0},_mouseStart:function(a,c,d){c=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-
this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");b.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};
this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();c.containment&&this._setContainment();c.cursor&&(b("body").css("cursor")&&(this._storedCursor=b("body").css("cursor")),b("body").css("cursor",c.cursor));c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity));c.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex));this.scrollParent[0]!=
document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",a,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(d=this.containers.length-1;0<=d;d--)this.containers[d]._trigger("activate",a,this._uiHash(this));b.ui.ddmanager&&(b.ui.ddmanager.current=this);b.ui.ddmanager&&!c.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,a);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(a);
return!0},_mouseDrag:function(a){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:a.pageY-this.overflowOffset.top<
c.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:a.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(a.pageY-b(document).scrollTop()<c.scrollSensitivity?d=b(document).scrollTop(b(document).scrollTop()-
c.scrollSpeed):b(window).height()-(a.pageY-b(document).scrollTop())<c.scrollSensitivity&&(d=b(document).scrollTop(b(document).scrollTop()+c.scrollSpeed)),a.pageX-b(document).scrollLeft()<c.scrollSensitivity?d=b(document).scrollLeft(b(document).scrollLeft()-c.scrollSpeed):b(window).width()-(a.pageX-b(document).scrollLeft())<c.scrollSensitivity&&(d=b(document).scrollLeft(b(document).scrollLeft()+c.scrollSpeed)));!1!==d&&b.ui.ddmanager&&!c.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,a)}this.positionAbs=
this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(c=this.items.length-1;0<=c;c--){var d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d);if(f&&e!=this.currentItem[0]&&this.placeholder[1==f?"next":"prev"]()[0]!=e&&!b.ui.contains(this.placeholder[0],e)&&("semi-dynamic"==this.options.type?!b.ui.contains(this.element[0],
e):1)){this.direction=1==f?"down":"up";if("pointer"==this.options.tolerance||this._intersectsWithSides(d))this._rearrange(a,d);else break;this._trigger("change",a,this._uiHash());break}}this._contactContainers(a);b.ui.ddmanager&&b.ui.ddmanager.drag(this,a);this._trigger("sort",a,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(a,c){if(a){b.ui.ddmanager&&!this.options.dropBehaviour&&b.ui.ddmanager.drop(this,a);if(this.options.revert){var d=this,e=d.placeholder.offset();
d.reverting=!0;b(this.helper).animate({left:e.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(a)})}else this._clear(a,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):
this.currentItem.show();for(var a=this.containers.length-1;0<=a;a--)this.containers[a]._trigger("deactivate",null,this._uiHash(this)),this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",null,this._uiHash(this)),this.containers[a].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),b.extend(this,{helper:null,
dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?b(this.domPosition.prev).after(this.currentItem):b(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(a){var c=this._getItemsAsjQuery(a&&a.connected),d=[],a=a||{};b(c).each(function(){var c=(b(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);c&&d.push((a.key||c[1]+"[]")+"="+(a.key&&a.expression?c[1]:c[2]))});!d.length&&a.key&&d.push(a.key+"=");return d.join("&")},toArray:function(a){var c=
this._getItemsAsjQuery(a&&a.connected),d=[],a=a||{};c.each(function(){d.push(b(a.item||this).attr(a.attribute||"id")||"")});return d},_intersectsWith:function(b){var c=this.positionAbs.left,d=c+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=b.left,h=g+b.width,i=b.top,j=i+b.height,l=this.offset.click.top,k=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?
"width":"height"]>b[this.floating?"width":"height"]?e+l>i&&e+l<j&&c+k>g&&c+k<h:g<c+this.helperProportions.width/2&&d-this.helperProportions.width/2<h&&i<e+this.helperProportions.height/2&&f-this.helperProportions.height/2<j},_intersectsWithPointer:function(a){var c=b.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),a=b.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),c=c&&a,a=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return!c?
!1:this.floating?d&&"right"==d||"down"==a?2:1:a&&("down"==a?2:1)},_intersectsWithSides:function(a){var c=b.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),a=b.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"==e&&a||"left"==e&&!a:d&&("down"==d&&c||"up"==d&&!c)},_getDragVerticalDirection:function(){var b=this.positionAbs.top-
this.lastPositionAbs.top;return 0!=b&&(0<b?"down":"up")},_getDragHorizontalDirection:function(){var b=this.positionAbs.left-this.lastPositionAbs.left;return 0!=b&&(0<b?"right":"left")},refresh:function(b){this._refreshItems(b);this.refreshPositions();return this},_connectWith:function(){var b=this.options;return b.connectWith.constructor==String?[b.connectWith]:b.connectWith},_getItemsAsjQuery:function(a){var c=[],d=[],e=this._connectWith();if(e&&a)for(a=e.length-1;0<=a;a--)for(var f=b(e[a]),g=f.length-
1;0<=g;g--){var h=b.data(f[g],this.widgetName);h&&h!=this&&!h.options.disabled&&d.push([b.isFunction(h.options.items)?h.options.items.call(h.element):b(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}d.push([b.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):b(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(a=d.length-1;0<=a;a--)d[a][0].each(function(){c.push(this)});
return b(c)},_removeCurrentsFromItems:function(){for(var b=this.currentItem.find(":data("+this.widgetName+"-item)"),c=0;c<this.items.length;c++)for(var d=0;d<b.length;d++)b[d]==this.items[c].item[0]&&this.items.splice(c,1)},_refreshItems:function(a){this.items=[];this.containers=[this];var c=this.items,d=[[b.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):b(this.options.items,this.element),this]],e=this._connectWith();if(e&&this.ready)for(var f=e.length-
1;0<=f;f--)for(var g=b(e[f]),h=g.length-1;0<=h;h--){var i=b.data(g[h],this.widgetName);i&&i!=this&&!i.options.disabled&&(d.push([b.isFunction(i.options.items)?i.options.items.call(i.element[0],a,{item:this.currentItem}):b(i.options.items,i.element),i]),this.containers.push(i))}for(f=d.length-1;0<=f;f--){a=d[f][1];e=d[f][0];h=0;for(g=e.length;h<g;h++)i=b(e[h]),i.data(this.widgetName+"-item",a),c.push({item:i,instance:a,width:0,height:0,left:0,top:0})}},refreshPositions:function(a){this.offsetParent&&
this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;0<=c;c--){var d=this.items[c];if(!(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])){var e=this.options.toleranceElement?b(this.options.toleranceElement,d.item):d.item;a||(d.width=e.outerWidth(),d.height=e.outerHeight());e=e.offset();d.left=e.left;d.top=e.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);
else for(c=this.containers.length-1;0<=c;c--)e=this.containers[c].element.offset(),this.containers[c].containerCache.left=e.left,this.containers[c].containerCache.top=e.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(a){var c=a||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var a=
b(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];e||(a.style.visibility="hidden");return a},update:function(b,a){if(!e||d.forcePlaceholderSize)a.height()||a.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||
0,10))}}}c.placeholder=b(d.placeholder.element.call(c.element,c.currentItem));c.currentItem.after(c.placeholder);d.placeholder.update(c,c.placeholder)},_contactContainers:function(a){for(var c=null,d=null,e=this.containers.length-1;0<=e;e--)if(!b.ui.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(!c||!b.ui.contains(this.containers[e].element[0],c.element[0]))c=this.containers[e],d=e}else this.containers[e].containerCache.over&&
(this.containers[e]._trigger("out",a,this._uiHash(this)),this.containers[e].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[d]._trigger("over",a,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){for(var c=1E4,e=null,f=this.positionAbs[this.containers[d].floating?"left":"top"],g=this.items.length-1;0<=g;g--)if(b.ui.contains(this.containers[d].element[0],this.items[g].item[0])){var h=this.items[g][this.containers[d].floating?
"left":"top"];Math.abs(h-f)<c&&(c=Math.abs(h-f),e=this.items[g])}if(e||this.options.dropOnEmpty)this.currentContainer=this.containers[d],e?this._rearrange(a,e,null,!0):this._rearrange(a,null,this.containers[d].element,!0),this._trigger("change",a,this._uiHash()),this.containers[d]._trigger("change",a,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",a,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(a){var c=
this.options,a=b.isFunction(c.helper)?b(c.helper.apply(this.element[0],[a,this.currentItem])):"clone"==c.helper?this.currentItem.clone():this.currentItem;a.parents("body").length||b("parent"!=c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]);a[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")});(""==
a[0].style.width||c.forceHelperSize)&&a.width(this.currentItem.width());(""==a[0].style.height||c.forceHelperSize)&&a.height(this.currentItem.height());return a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));b.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in
a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&
b.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var b=this.currentItem.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins=
{left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-
this.offset.parent.top,b("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,(b("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)){var c=b(a.containment)[0],a=b(a.containment).offset(),d="hidden"!=b(c).css("overflow");this.containment=[a.left+(parseInt(b(c).css("borderLeftWidth"),10)||0)+(parseInt(b(c).css("paddingLeft"),
10)||0)-this.margins.left,a.top+(parseInt(b(c).css("borderTopWidth"),10)||0)+(parseInt(b(c).css("paddingTop"),10)||0)-this.margins.top,a.left+(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(b(c).css("borderLeftWidth"),10)||0)-(parseInt(b(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(b(c).css("borderTopWidth"),10)||0)-(parseInt(b(c).css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top]}},_convertPositionTo:function(a,c){c||(c=this.position);var d="absolute"==a?1:-1,e="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(b.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d),left:c.left+
this.offset.relative.left*d+this.offset.parent.left*d-(b.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d)}},_generatePosition:function(a){var c=this.options,d="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==
this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=a.pageX,g=a.pageY;this.originalPosition&&(this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),a.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+
this.offset.click.top)),c.grid&&(g=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1],g=this.containment?g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3]?g-this.offset.click.top<this.containment[1]?g+c.grid[1]:g-c.grid[1]:g:g,f=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0],f=this.containment?f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2]?f-this.offset.click.left<this.containment[0]?
f+c.grid[0]:f-c.grid[0]:f:f));return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(b.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(b.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(b,c,d,e){d?d[0].appendChild(this.placeholder[0]):
c.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?c.item[0]:c.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var f=this,g=this.counter;window.setTimeout(function(){g==f.counter&&f.refreshPositions(!e)},0)},_clear:function(a,c){this.reverting=!1;var d=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS)if("auto"==this._storedCSS[e]||
"static"==this._storedCSS[e])this._storedCSS[e]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(b){this._trigger("receive",b,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(b){this._trigger("update",b,this._uiHash())});if(!b.ui.contains(this.element[0],
this.currentItem[0])){c||d.push(function(b){this._trigger("remove",b,this._uiHash())});for(e=this.containers.length-1;0<=e;e--)b.ui.contains(this.containers[e].element[0],this.currentItem[0])&&!c&&(d.push(function(b){return function(a){b._trigger("receive",a,this._uiHash(this))}}.call(this,this.containers[e])),d.push(function(b){return function(a){b._trigger("update",a,this._uiHash(this))}}.call(this,this.containers[e])))}for(e=this.containers.length-1;0<=e;e--)c||d.push(function(b){return function(a){b._trigger("deactivate",
a,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over&&(d.push(function(b){return function(a){b._trigger("out",a,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over=0);this._storedCursor&&b("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",
a,this._uiHash());for(e=0;e<d.length;e++)d[e].call(this,a);this._trigger("stop",a,this._uiHash())}return!1}c||this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!c){for(e=0;e<d.length;e++)d[e].call(this,a);this._trigger("stop",a,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){!1===b.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},
_uiHash:function(a){var c=a||this;return{helper:c.helper,placeholder:c.placeholder||b([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:a?a.element:null}}});b.extend(b.ui.sortable,{version:"1.8.18"})})(jQuery);
jQuery.effects||function(b,a){function c(a){return!a||"number"==typeof a||b.fx.speeds[a]||"string"==typeof a&&!b.effects[a]?!0:!1}function d(a,c,d,e){"object"==typeof a&&(e=c,d=null,c=a,a=c.effect);b.isFunction(c)&&(e=c,d=null,c={});if("number"==typeof c||b.fx.speeds[c])e=d,d=c,c={};b.isFunction(d)&&(e=d,d=null);c=c||{};d=d||c.duration;d=b.fx.off?0:"number"==typeof d?d:d in b.fx.speeds?b.fx.speeds[d]:b.fx.speeds._default;e=e||c.complete;return[a,c,d,e]}function e(b,a){var c={_:0},d;for(d in a)b[d]!=
a[d]&&(c[d]=a[d]);return c}function f(a){var c,d;for(c in a)d=a[c],(null==d||b.isFunction(d)||c in l||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete a[c];return a}function g(){var b=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,a={},c,d;if(b&&b.length&&b[0]&&b[b[0]])for(var e=b.length;e--;)c=b[e],"string"==typeof b[c]&&(d=c.replace(/\-(\w)/g,function(b,a){return a.toUpperCase()}),a[d]=b[c]);else for(c in b)"string"==typeof b[c]&&(a[c]=
b[c]);return a}function h(a){var c;return a&&a.constructor==Array&&3==a.length?a:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))?[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]:(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(a))?[2.55*parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3])]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],
16)]:(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a))?[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]:/rgba\(0, 0, 0, 0\)/.exec(a)?i.transparent:i[b.trim(a).toLowerCase()]}b.effects={};b.each("backgroundColor,borderBottomColor,borderLeftColor,borderRightColor,borderTopColor,borderColor,color,outlineColor".split(","),function(a,c){b.fx.step[c]=function(a){if(!a.colorInit){var d;d=a.elem;var e=c,f;do{f=b.curCSS(d,e);if(f!=""&&f!="transparent"||b.nodeName(d,"body"))break;
e="backgroundColor"}while(d=d.parentNode);d=h(f);a.start=d;a.end=h(a.end);a.colorInit=true}a.elem.style[c]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var i={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,
0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,
255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},j=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};b.effects.animateClass=function(a,c,d,h){b.isFunction(d)&&(h=d,d=null);return this.queue(function(){var i=
b(this),l=i.attr("style")||" ",r=f(g.call(this)),s,q=i.attr("class");b.each(j,function(b,c){a[c]&&i[c+"Class"](a[c])});s=f(g.call(this));i.attr("class",q);i.animate(e(r,s),{queue:!1,duration:c,easing:d,complete:function(){b.each(j,function(b,c){a[c]&&i[c+"Class"](a[c])});"object"==typeof i.attr("style")?(i.attr("style").cssText="",i.attr("style").cssText=l):i.attr("style",l);h&&h.apply(this,arguments);b.dequeue(this)}})})};b.fn.extend({_addClass:b.fn.addClass,addClass:function(a,c,d,e){return c?b.effects.animateClass.apply(this,
[{add:a},c,d,e]):this._addClass(a)},_removeClass:b.fn.removeClass,removeClass:function(a,c,d,e){return c?b.effects.animateClass.apply(this,[{remove:a},c,d,e]):this._removeClass(a)},_toggleClass:b.fn.toggleClass,toggleClass:function(c,d,e,f,g){return"boolean"==typeof d||d===a?e?b.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):b.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(a,c,d,e,f){return b.effects.animateClass.apply(this,[{add:c,
remove:a},d,e,f])}});b.extend(b.effects,{version:"1.8.18",save:function(b,a){for(var c=0;c<a.length;c++)null!==a[c]&&b.data("ec.storage."+a[c],b[0].style[a[c]])},restore:function(b,a){for(var c=0;c<a.length;c++)null!==a[c]&&b.css(a[c],b.data("ec.storage."+a[c]))},setMode:function(b,a){"toggle"==a&&(a=b.is(":hidden")?"show":"hide");return a},getBaseline:function(b,a){var c,d;switch(b[0]){case "top":c=0;break;case "middle":c=0.5;break;case "bottom":c=1;break;default:c=b[0]/a.height}switch(b[1]){case "left":d=
0;break;case "center":d=0.5;break;case "right":d=1;break;default:d=b[1]/a.width}return{x:d,y:c}},createWrapper:function(a){if(a.parent().is(".ui-effects-wrapper"))return a.parent();var c={width:a.outerWidth(!0),height:a.outerHeight(!0),"float":a.css("float")},d=b("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e=document.activeElement;a.wrap(d);(a[0]===e||b.contains(a[0],e))&&b(e).focus();d=a.parent();"static"==a.css("position")?
(d.css({position:"relative"}),a.css({position:"relative"})):(b.extend(c,{position:a.css("position"),zIndex:a.css("z-index")}),b.each(["top","left","bottom","right"],function(b,d){c[d]=a.css(d);isNaN(parseInt(c[d],10))&&(c[d]="auto")}),a.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));return d.css(c).show()},removeWrapper:function(a){var c,d=document.activeElement;return a.parent().is(".ui-effects-wrapper")?(c=a.parent().replaceWith(a),(a[0]===d||b.contains(a[0],d))&&b(d).focus(),
c):a},setTransition:function(a,c,d,e){e=e||{};b.each(c,function(b,c){unit=a.cssUnit(c);0<unit[0]&&(e[c]=unit[0]*d+unit[1])});return e}});b.fn.extend({effect:function(a,c,e,f){var g=d.apply(this,arguments),h={options:g[1],duration:g[2],callback:g[3]},g=h.options.mode,i=b.effects[a];return b.fx.off||!i?g?this[g](h.duration,h.callback):this.each(function(){h.callback&&h.callback.call(this)}):i.call(this,h)},_show:b.fn.show,show:function(b){if(c(b))return this._show.apply(this,arguments);var a=d.apply(this,
arguments);a[1].mode="show";return this.effect.apply(this,a)},_hide:b.fn.hide,hide:function(b){if(c(b))return this._hide.apply(this,arguments);var a=d.apply(this,arguments);a[1].mode="hide";return this.effect.apply(this,a)},__toggle:b.fn.toggle,toggle:function(a){if(c(a)||"boolean"==typeof a||b.isFunction(a))return this.__toggle.apply(this,arguments);var e=d.apply(this,arguments);e[1].mode="toggle";return this.effect.apply(this,e)},cssUnit:function(a){var c=this.css(a),d=[];b.each(["em","px","%",
"pt"],function(b,a){0<c.indexOf(a)&&(d=[parseFloat(c),a])});return d}});b.easing.jswing=b.easing.swing;b.extend(b.easing,{def:"easeOutQuad",swing:function(a,c,d,e,f){return b.easing[b.easing.def](a,c,d,e,f)},easeInQuad:function(b,a,c,d,e){return d*(a/=e)*a+c},easeOutQuad:function(b,a,c,d,e){return-d*(a/=e)*(a-2)+c},easeInOutQuad:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*a*a+c:-d/2*(--a*(a-2)-1)+c},easeInCubic:function(b,a,c,d,e){return d*(a/=e)*a*a+c},easeOutCubic:function(b,a,c,d,e){return d*((a=
a/e-1)*a*a+1)+c},easeInOutCubic:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a+c:d/2*((a-=2)*a*a+2)+c},easeInQuart:function(b,a,c,d,e){return d*(a/=e)*a*a*a+c},easeOutQuart:function(b,a,c,d,e){return-d*((a=a/e-1)*a*a*a-1)+c},easeInOutQuart:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a*a+c:-d/2*((a-=2)*a*a*a-2)+c},easeInQuint:function(b,a,c,d,e){return d*(a/=e)*a*a*a*a+c},easeOutQuint:function(b,a,c,d,e){return d*((a=a/e-1)*a*a*a*a+1)+c},easeInOutQuint:function(b,a,c,d,e){return 1>(a/=e/2)?d/2*
a*a*a*a*a+c:d/2*((a-=2)*a*a*a*a+2)+c},easeInSine:function(b,a,c,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+c},easeOutSine:function(b,a,c,d,e){return d*Math.sin(a/e*(Math.PI/2))+c},easeInOutSine:function(b,a,c,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+c},easeInExpo:function(b,a,c,d,e){return 0==a?c:d*Math.pow(2,10*(a/e-1))+c},easeOutExpo:function(b,a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOutExpo:function(b,a,c,d,e){return 0==a?c:a==e?c+d:1>(a/=e/2)?d/2*Math.pow(2,10*(a-1))+c:d/
2*(-Math.pow(2,-10*--a)+2)+c},easeInCirc:function(b,a,c,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+c},easeOutCirc:function(b,a,c,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+c},easeInOutCirc:function(b,a,c,d,e){return 1>(a/=e/2)?-d/2*(Math.sqrt(1-a*a)-1)+c:d/2*(Math.sqrt(1-(a-=2)*a)+1)+c},easeInElastic:function(b,a,c,d,e){var b=1.70158,f=0,g=d;if(0==a)return c;if(1==(a/=e))return c+d;f||(f=0.3*e);g<Math.abs(d)?(g=d,b=f/4):b=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*e-b)*Math.PI/
f))+c},easeOutElastic:function(b,a,c,d,e){var b=1.70158,f=0,g=d;if(0==a)return c;if(1==(a/=e))return c+d;f||(f=0.3*e);g<Math.abs(d)?(g=d,b=f/4):b=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*a)*Math.sin(2*(a*e-b)*Math.PI/f)+d+c},easeInOutElastic:function(b,a,c,d,e){var b=1.70158,f=0,g=d;if(0==a)return c;if(2==(a/=e/2))return c+d;f||(f=1.5*0.3*e);g<Math.abs(d)?(g=d,b=f/4):b=f/(2*Math.PI)*Math.asin(d/g);return 1>a?-0.5*g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*e-b)*Math.PI/f)+c:0.5*g*Math.pow(2,
-10*(a-=1))*Math.sin(2*(a*e-b)*Math.PI/f)+d+c},easeInBack:function(b,c,d,e,f,g){g==a&&(g=1.70158);return e*(c/=f)*c*((g+1)*c-g)+d},easeOutBack:function(b,c,d,e,f,g){g==a&&(g=1.70158);return e*((c=c/f-1)*c*((g+1)*c+g)+1)+d},easeInOutBack:function(b,c,d,e,f,g){g==a&&(g=1.70158);return 1>(c/=f/2)?e/2*c*c*(((g*=1.525)+1)*c-g)+d:e/2*((c-=2)*c*(((g*=1.525)+1)*c+g)+2)+d},easeInBounce:function(a,c,d,e,f){return e-b.easing.easeOutBounce(a,f-c,0,e,f)+d},easeOutBounce:function(b,a,c,d,e){return(a/=e)<1/2.75?
7.5625*d*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+c:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+c},easeInOutBounce:function(a,c,d,e,f){return c<f/2?0.5*b.easing.easeInBounce(a,2*c,0,e,f)+d:0.5*b.easing.easeOutBounce(a,2*c-f,0,e,f)+0.5*e+d}})}(jQuery);
(function(b){function a(a,d){var e,f,g,h;function i(a){v.start=u?a.pageX:a.pageY;a=parseInt(o.obj.css(r));e="auto"==a?0:a;b(document).bind("mousemove",k);document.ontouchmove=function(a){b(document).unbind("mousemove");k(a.touches[0])};b(document).bind("mouseup",l);o.obj.bind("mouseup",l);o.obj[0].ontouchend=document.ontouchend=function(a){b(document).unbind("mouseup");o.obj.unbind("mouseup");l(a.touches[0])};return!1}function j(a){if(!(1<=m.ratio)){var a=b.event.fix(a||window.event),c=a.wheelDelta||
a.originalEvent&&a.originalEvent.wheelDelta;q-=(c?c/120:-(a.detail||a.originalEvent&&a.originalEvent.detail)/3)*d.wheel;q=Math.min(m[d.axis]-n[d.axis],Math.max(0,q));o.obj.css(r,q/g);m.obj.css(r,-q);a.preventDefault()}}function l(){b(document).unbind("mousemove",k);b(document).unbind("mouseup",l);o.obj.unbind("mouseup",l);document.ontouchmove=o.obj[0].ontouchend=document.ontouchend=null;return!1}function k(a){1<=m.ratio||(f=Math.min(p[d.axis]-o[d.axis],Math.max(0,e+((u?a.pageX:a.pageY)-v.start))),
q=f*g,m.obj.css(r,-q),o.obj.css(r,f));return!1}var n={obj:b(".viewport",a)},m={obj:b(".overview",a)};h=b(".scrollbar",a);g=void 0;var p={obj:b(".track",h)},o={obj:b(".thumb",h)},u="x"==d.axis,r=u?"left":"top",s=u?"Width":"Height",q;f=e=0;var v={};this.update=function(a){n[d.axis]=n.obj[0]["offset"+s];m[d.axis]=m.obj[0]["scroll"+s];m.ratio=n[d.axis]/m[d.axis];h.toggleClass("disable",1<=m.ratio);p[d.axis]="auto"==d.size?n[d.axis]:d.size;o[d.axis]=Math.min(p[d.axis],Math.max(0,"auto"==d.sizethumb?p[d.axis]*
m.ratio:d.sizethumb));g="auto"==d.sizethumb?m[d.axis]/p[d.axis]:(m[d.axis]-n[d.axis])/(p[d.axis]-o[d.axis]);q="relative"==a&&1>=m.ratio?Math.min(m[d.axis]-n[d.axis],Math.max(0,q)):0;q="bottom"==a&&1>=m.ratio?m[d.axis]-n[d.axis]:isNaN(parseInt(a))?q:parseInt(a);o.obj.css(r,q/g);m.obj.css(r,-q);v.start=o.obj.offset()[r];a=s.toLowerCase();h.css(a,p[d.axis]);p.obj.css(a,p[d.axis]);o.obj.css(a,o[d.axis])};this.update();(function(){o.obj.bind("mousedown",i);o.obj[0].ontouchstart=function(a){a.preventDefault();
o.obj.unbind("mousedown");i(a.touches[0]);return!1};p.obj.bind("mouseup",k);d.scroll&&this.addEventListener?(a[0].addEventListener("DOMMouseScroll",j,!1),a[0].addEventListener("mousewheel",j,!1)):d.scroll&&(a[0].onmousewheel=j)})();return this}b.tiny=b.tiny||{};b.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,size:"auto",sizethumb:"auto"}};b.fn.tinyscrollbar=function(c){c=b.extend({},b.tiny.scrollbar.options,c);this.each(function(){b(this).data("tsb",new a(b(this),c))});return this};b.fn.tinyscrollbar_update=
function(a){return b(this).data("tsb").update(a)}})(jQuery);
(function(b){function a(a){var c=a||window.event,d=[].slice.call(arguments,1),h=0,i=0,j=0,a=b.event.fix(c);a.type="mousewheel";c.wheelDelta&&(h=c.wheelDelta/120);c.detail&&(h=-c.detail/3);j=h;void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(j=0,i=-1*h);void 0!==c.wheelDeltaY&&(j=c.wheelDeltaY/120);void 0!==c.wheelDeltaX&&(i=-1*c.wheelDeltaX/120);d.unshift(a,h,i,j);return(b.event.dispatch||b.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(b.event.fixHooks)for(var d=c.length;d;)b.event.fixHooks[c[--d]]=
b.event.mouseHooks;b.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var b=c.length;b;)this.addEventListener(c[--b],a,!1);else this.onmousewheel=a},teardown:function(){if(this.removeEventListener)for(var b=c.length;b;)this.removeEventListener(c[--b],a,!1);else this.onmousewheel=null}};b.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
jQuery.fn.liveDraggable=function(b){this.live("mouseover",function(){if(!$(this).data("initDraggable")){var a=$(this).hasClass("screen")&&$(this).hasClass("active");(1>project.get("currentZoom")||!a||a&&$(this).data("initSelectable"))&&$(this).data("initDraggable",!0).draggable(b)}});return $(this)};jQuery.fn.liveSelectable=function(b){this.live("mouseover",function(){!project.readOnly()&&!$(this).data("initSelectable")&&$(this).data("initSelectable",!0).selectable(b)});return $(this)};
(function(b){b.fn.extend({bounce:function(a){a=b.extend({size:[0.33,1.33,1,1.12,1,1.05,1],delay:[0,100,80,80,80,80,50],step:function(b){var d=b.data("bounce");if(d&&d.nextStep<d.size.length){var e=0<d.nextStep?d.size[d.nextStep-1]:0,f=d.size[d.nextStep]-e;utils.animateRaf(function(a){b.css({"-webkit-transform":"scale("+(e+f*a)+")","-moz-transform":"scale("+(e+f*a)+")"})},d.delay[d.nextStep],function(){a.step(b)});d.nextStep++}else b.css({"-webkit-transform":"none","-moz-transform":"none"})}},a);return this.each(function(){var c=
b(this).data("bounce",{size:a.size,delay:a.delay,nextStep:0}).css({"-webkit-transform":"scale(0.01)","-moz-transform":"scale(0.01)"});a.step(c)})}})})(jQuery);
function zoomAction(b,a,c,d,e,f,g,h){var i=$("#canvas"),j=$("#canvasPages"),l=i.position(),k=i.width(),n=i.height(),m=1;if($.browser.webkit)m=(new WebKitCSSMatrix(j.css("-webkit-transform"))).a;else{var p=j.css("-moz-transform");(p=p.match(/scale\s*\(\s*([\d\.]+)\s*\)/)||p.match(/matrix\s*\(\s*([\d\.]+)/))&&(m=parseFloat(p[1]))}var o=b-l.top,u=a-l.left,r=c-k,s=d-n,q=e-m,v=g&&$.isFunction(g);utils.animateRaf(function(a){i.css({top:l.top+o*a+"px",left:l.left+u*a+"px",width:k+r*a+"px",height:n+s*a+"px"});
j.css({"-webkit-transform":"scale("+(m+q*a)+")","-moz-transform":"scale("+(m+q*a)+")"});v&&g(a)},f,"easeInOutQuad",function(){window.setTimeout(zoomActionCallback,10);h&&$.isFunction(h)&&h()});project.set({currentZoom:e})}
function dragZoom(b){$("#addPage").data("position",$("#addPage").css("right")).css({right:"0px"});$("#hud, #trash").fadeOut(300);$(".template").fadeTo(300,0.2);if(!(1>project.get("currentZoom"))){setZoomedOutActions();var a,c;if($(b).hasClass("templateLink"))a=$(b),c="template";else if("cmLink2"==$(b).attr("id"))a=$(".zoomedOutSelected"),c="ahref";else return;var b=$("#canvas").data("lastOutX"),d=$("#canvas").data("lastOutY");zoomAction(d,b,0.25*project.get("canvasWidth"),0.25*project.get("canvasHeight"),
0.25,300,null,function(){link.draw($("#dragCanvas"),a,$(".connectorHelper"),c);$("#dragCanvas").fadeIn(200)});$("#library").hide()}}function dragZoomStop(){$("#addPage").css({right:$("#addPage").data("position")||10});$("#hud").fadeIn(300);$("#trash").fadeIn(300);$(".screen").stop().fadeTo(300,1)}
function setZoomedInActions(){project.readOnly();0==$("#canvasPages .active").length&&page.activate($("#canvasPages .activeZoomedOut"));$(".pageWidget").draggable("enable");$(".zoomedOutSelected").removeClass("zoomedOutSelected");$("#canvas").draggable("option","distance",50).addClass("canvas100").removeClass("zoomedOut");$("#canvasPages .activeZoomedOut").removeClass("activeZoomedOut");$(".screen").draggable("option","handle",".pageDragHandle");var b=$(".screen.active .selectArea");b.length&&b.tinyscrollbar_update();
project.readOnly()||$(".active .selectArea").selectable("enable")}function zoomOutToLastPoint(b,a,c){var b=$("#canvas").data("lastOutX"),d=$("#canvas").data("lastOutY");zoomAction(d,b,project.get("canvasWidth")*a,project.get("canvasHeight")*a,a,c);page.enableSelectableWidgetHolder(!1)}
function setZoomedOutActions(){$(".screen").not(".active, .activeZoomedOut").hide();page.hideOptionsMenu();page.detachFrame();contextMenu.hide();$("#library").hide();$("#projectView").fadeOut(500);$(".screen.active").selectable("destroy").removeData("initSelectable");$("#canvasPages .active");$("#canvasPages .active").addClass("activeZoomedOut").removeClass("active");$(".pageWidget").draggable("disable");$("#canvas").removeClass("canvas100").addClass("zoomedOut").draggable("option","distance",4);
$(".ui-selected").addClass("zoomedOutSelected");$(".screen").draggable("option","distance",10);widget.resetSelection();$(".screen").draggable("option","handle",!1)}
function zoomActionCallback(){function b(){var a=$(".screen").not(":visible").add("#canvasLinks");a.show().css({opacity:0});setTimeout(function(){a.css({"-webkit-transition":"opacity 0.3s ease-in-out","-moz-transition":"opacity 0.3s ease-in-out",opacity:1}).bind("webkitTransitionEnd",function(){a.unbind("webkitTransitionEnd").css({"-webkit-transition":"","-moz-transition":""})});link.drawAll("ahref")},10)}$("#canvas").draggable("option","containment",canvas2.setContainment()).css({"-webkit-transition":"none",
"-moz-transition":"none"}).data("zooming",!1);canvas2.setScreenContainment();var a=!1;1==project.get("currentZoom")&&(project.readOnly()||($("#library").is(":visible")||lib.show(b),a=!0),$("#projectView").fadeIn(200));a||b()}function zoomInOnPoint(b,a,c,d,e){var f=parseInt($("#canvas").css("top")),g=parseInt($("#canvas").css("left"));zoomAction(a-(a-f)/c*d,b-(b-g)/c*d,project.get("canvasWidth"),project.get("canvasWidth"),d,e)}
function zoomOutToAllPages(b,a){var c=utils.getTLWH("#viewport");utils.getCenterPoint("#viewport");var d=utils.getTLWH("#canvas"),e=utils.getBoundingArea(".page"),c=Math.min(c.width/(e.right-e.left),c.height/(e.bottom-e.top));0.25<c&&(c=0.25);var f=10+d.top*c-e.top*c,d=10+d.left*c-e.left*c,e=project.get("canvasWidth")*c,g=project.get("canvasHeight")*c;zoomAction(f,d,e,g,c,a)}
function zoomInAndCenterOnPage(b,a,c,d){var e=utils.getTranslateDistanceToCenter(b,"#viewport");a!=c&&$("#canvasPages .screen").not(b).hide();b=0;!project.readOnly()&&"0px"==$("#library").css("left")&&(b=Math.floor(account.get("libraryWidth")/2));if(0==e.top&&0==e.left+b&&1==a&&1==c)return!1;a=e.top+parseInt($("#canvas").css("top"));e=e.left+b+parseInt($("#canvas").css("left"));zoomAction(a,e,project.get("canvasWidth"),project.get("canvasHeight"),c,d);page.enableSelectableWidgetHolder();return!0}
(function(b){b.fn.extend({zoom:function(a){a=b.extend({currentZoom:!1,newZoom:!1,duration:400,centerIn:"#viewport",centerX:!1,centerY:!1,canvasX:!1,canvasY:!1,page:!1,centering:!1,savePosition:!0},a);if(b("#canvas").data("zooming"))return this;if(!(0==project.get("pages").length&&1==a.newZoom)){!1==a.currentZoom&&(a.currentZoom=project.get("currentZoom"));if(a.currentZoom==a.newZoom)return!0;"auto"==a.newZoom&&(a.newZoom=0.25);b("#canvas").data("zooming",!0);b("#canvasLinks").filter(":visible").hide();
1==a.newZoom?setZoomedInActions():setZoomedOutActions();!1!==a.page&&1==a.newZoom?(a.currentZoom<a.newZoom&&!1!=a.savePosition&&b("#canvas").data("lastOutX",parseInt(b("#canvas").css("left"))).data("lastOutY",parseInt(b("#canvas").css("top"))),zoomInAndCenterOnPage(a.page,a.currentZoom,a.newZoom,a.duration)):!1!==a.centerX&&!1!==a.centerY&&1==a.newZoom?zoomInOnPoint(a.centerX,a.centerY,a.currentZoom,a.newZoom,a.duration):!1!=a.centering?zoomOutToAllPages(a.centering,a.duration):!1!==a.centerX&&!1!==
a.centerY&&zoomOutToLastPoint(a.currentZoom,a.newZoom,a.duration);return this}}})})(jQuery);
(function(b){function a(a,c,d){var h=d.relative?a.position().top:a.offset().top,i=d.relative?a.position().left:a.offset().left,j=d.position[0],h=h-(c.outerHeight()-d.offset[0]),i=i+(a.outerWidth()+d.offset[1]);/iPad/i.test(navigator.userAgent)&&(h-=b(window).scrollTop());var l=c.outerHeight()+a.outerHeight();"center"==j&&(h+=l/2);"bottom"==j&&(h+=l);j=d.position[1];a=c.outerWidth()+a.outerWidth();"center"==j&&(i-=a/2);"left"==j&&(i-=a);return{top:h,left:i}}function c(c,f){var g=this,h=c.add(g),i,
j=0,l=0,k=c.attr("title"),n=c.attr("data-tooltip"),m=d[f.effect],p,o=c.is(":input"),u=o&&c.is(":checkbox, :radio, select, :button, :submit"),r=c.attr("type"),s=f.events[r]||f.events[o?u?"widget":"input":"def"];if(!m)throw'Nonexistent effect "'+f.effect+'"';s=s.split(/,\s*/);if(2!=s.length)throw"Tooltip: bad events configuration for "+r;c.bind(s[0],function(a){clearTimeout(j);f.predelay?l=setTimeout(function(){g.show(a)},f.predelay):g.show(a)}).bind(s[1],function(a){clearTimeout(l);f.delay?j=setTimeout(function(){g.hide(a)},
f.delay):g.hide(a)});k&&f.cancelDefault&&(c.removeAttr("title"),c.data("title",k));b.extend(g,{show:function(d){if(!i){if(n)i=b(n);else if(f.tip)i=b(f.tip).eq(0);else if(k)i=b(f.layout).addClass(f.tipClass).appendTo(document.body).hide().append(k);else{i=c.next();i.length||(i=c.parent().next())}if(!i.length)throw"Cannot find tooltip for "+c;}if(g.isShown())return g;i.stop(true,true);var o=a(c,i,f);f.tip&&i.html(c.data("title"));d=d||b.Event();d.type="onBeforeShow";h.trigger(d,[o]);if(d.isDefaultPrevented())return g;
o=a(c,i,f);i.css({position:"absolute",top:o.top,left:o.left});p=true;m[0].call(g,function(){d.type="onShow";p="full";h.trigger(d)});o=f.events.tooltip.split(/,\s*/);if(!i.data("__set")){i.bind(o[0],function(){clearTimeout(j);clearTimeout(l)});o[1]&&!c.is("input:not(:checkbox, :radio), textarea")&&i.bind(o[1],function(a){a.relatedTarget!=c[0]&&c.trigger(s[1].split(" ")[0])});i.data("__set",true)}return g},hide:function(a){if(!i||!g.isShown())return g;a=a||b.Event();a.type="onBeforeHide";h.trigger(a);
if(!a.isDefaultPrevented()){p=false;d[f.effect][1].call(g,function(){a.type="onHide";h.trigger(a)});return g}},isShown:function(a){return a?p=="full":p},getConf:function(){return f},getTip:function(){return i},getTrigger:function(){return c}});b.each(["onHide","onBeforeShow","onShow","onBeforeHide"],function(a,c){b.isFunction(f[c])&&b(g).bind(c,f[c]);g[c]=function(a){a&&b(g).bind(c,a);return g}})}b.tools=b.tools||{version:"@VERSION"};b.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0.5,
delay:10,opacity:1,tip:0,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(a,b,c){d[a]=[b,c]}};var d={toggle:[function(a){var b=this.getConf(),c=this.getTip(),b=b.opacity;1>b&&c.css({opacity:b});c.show();a.call()},function(a){this.getTip().hide();a.call()}],fade:[function(a){var b=this.getConf();this.getTip().fadeTo(b.fadeInSpeed,
b.opacity,a)},function(a){this.getTip().fadeOut(this.getConf().fadeOutSpeed,a)}]};b.fn.tooltip=function(a){var d=this.data("tooltip");if(d)return d;a=b.extend(!0,{},b.tools.tooltip.conf,a);"string"==typeof a.position&&(a.position=a.position.split(/,?\s/));this.each(function(){d=new c(b(this),a);b(this).data("tooltip",d)});return a.api?d:this}})(jQuery);
$.fn.simpleColorPicker=function(b){var a={colorsPerLine:8,colors:"#000000,#444444,#666666,#999999,#cccccc,#eeeeee,#f3f3f3,#ffffff,#ff0000,#ff9900,#ffff00,#00ff00,#00ffff,#0000ff,#9900ff,#ff00ff,#f4cccc,#fce5cd,#fff2cc,#d9ead3,#d0e0e3,#cfe2f3,#d9d2e9,#ead1dc,#ea9999,#f9cb9c,#ffe599,#b6d7a8,#a2c4c9,#9fc5e8,#b4a7d6,#d5a6bd,#e06666,#f6b26b,#ffd966,#93c47d,#76a5af,#6fa8dc,#8e7cc3,#c27ba0,#cc0000,#e69138,#f1c232,#6aa84f,#45818e,#3d85c6,#674ea7,#a64d79,#990000,#b45f06,#bf9000,#38761d,#134f5c,#0b5394,#351c75,#741b47,#660000,#783f04,#7f6000,#274e13,#0c343d,#073763,#20124d,#4C1130".split(","),showEffect:"",
hideEffect:"",onChangeColor:!1},c=$.extend(a,b);return this.each(function(){function b(a){"fade"==c.hideEffect?a.fadeOut():"slide"==c.hideEffect?a.slideUp():a.hide()}function e(a){return 1==a.length?"0"+a:a}for(var f=$(this),g="",h=f.attr("id").replace(/-/g,"")+"_",i=0;i<c.colors.length;i++){var j=c.colors[i],l="";0==i%c.colorsPerLine&&(l="clear: both; ");0<i&&l&&$.browser&&$.browser.msie&&7>=$.browser.version&&(l="",g+='<li style="float: none; clear: both; overflow: hidden; background-color: #fff; display: block; height: 1px; line-height: 1px; font-size: 1px; margin-bottom: -2px;"></li>');
g+='<li id="'+h+"color-"+i+'" class="color-box" style="'+l+"background-color: "+j+'" title="'+j+'"></li>'}g={prefix:h,colorsMarkup:g};$("#tmplColorPickerBox").tmpl(g).appendTo("body");var k=$("#"+h+"color-picker");k.hide();k.find("li.color-box").click(function(){f.is("input")||(f.val(c.colors[this.id.substr(this.id.indexOf("-")+1)]),f.blur());$.isFunction(a.onChangeColor)&&a.onChangeColor.call(f,c.colors[this.id.substr(this.id.indexOf("-")+1)]);b(k)});$("body").live("click",function(){b(k)});k.click(function(a){a.stopPropagation()});
var n=function(b){var d=f.offset(),g=d.left+f.outerWidth()-b.outerWidth();g<d.left&&(g=d.left);b.css({left:g,top:d.top+f.outerHeight()});"fade"==c.showEffect?b.fadeIn():"slide"==c.showEffect?b.slideDown():b.show();b=b.find(".color-box");b.removeClass("color-above-selected").removeClass("color-pre-selected").removeClass("color-selected");d=f.css("background-color");g=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(d);null==g&&(g=/rgba?\((\d+), (\d+), (\d+)/.exec(d));d="#"+e(parseInt(g[2]).toString(16))+e(parseInt(g[3]).toString(16))+
e(parseInt(g[4]).toString(16));d=a.colors.indexOf(d);b.eq(d-8).addClass("color-above-selected");b.eq(d-1).addClass("color-pre-selected");b.eq(d).addClass("color-selected")};f.click(function(a){a.stopPropagation();f.is("input")||(k.siblings(".color-picker").hide(),"none"==k.css("display")?n(k):propInspector.hideColorPickers())});f.focus(function(){n(k)})})};
(function(b){b.fn.extend({simulate:function(a,c){return this.each(function(){var d=b.extend({},b.simulate.defaults,c||{});new b.simulate(this,a,d)})}});b.simulate=function(a,b,d){this.target=a;this.options=d;/^drag$/.test(b)?this[b].apply(this,[this.target,d]):this.simulateEvent(a,b,d)};b.extend(b.simulate.prototype,{simulateEvent:function(a,b,d){var e=this.createEvent(b,d);this.dispatchEvent(a,b,e,d);return e},createEvent:function(a,b){if(/^mouse(over|out|down|up|move)|(dbl)?click$/.test(a))return this.mouseEvent(a,
b);if(/^key(up|down|press)$/.test(a))return this.keyboardEvent(a,b)},mouseEvent:function(a,c){var d,e=b.extend({bubbles:!0,cancelable:"mousemove"!=a,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},c);b(e.relatedTarget);b.isFunction(document.createEvent)?(d=document.createEvent("MouseEvents"),d.initMouseEvent(a,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,
e.metaKey,e.button,e.relatedTarget||document.body.parentNode)):document.createEventObject&&(d=document.createEventObject(),b.extend(d,e),d.button={"0":1,1:4,2:2}[d.button]||d.button);return d},keyboardEvent:function(a,c){var d,e=b.extend({bubbles:!0,cancelable:!0,view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},c);if(b.isFunction(document.createEvent))try{d=document.createEvent("KeyEvents"),d.initKeyEvent(a,e.bubbles,e.cancelable,e.view,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,
e.keyCode,e.charCode)}catch(f){d=document.createEvent("Events"),d.initEvent(a,e.bubbles,e.cancelable),b.extend(d,{view:e.view,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,keyCode:e.keyCode,charCode:e.charCode})}else document.createEventObject&&(d=document.createEventObject(),b.extend(d,e));if(b.browser.msie||b.browser.opera)d.keyCode=0<e.charCode?e.charCode:e.keyCode,d.charCode=void 0;return d},dispatchEvent:function(a,b,d){a.dispatchEvent?a.dispatchEvent(d):a.fireEvent&&
a.fireEvent("on"+b,d);return d},drag:function(){var a=this.findCenter(this.target),b=this.options,d=Math.floor(a.x),a=Math.floor(a.y),e=b.dx||0,b=b.dy||0,f=this.target,g={clientX:d,clientY:a};this.simulateEvent(f,"mousedown",g);g={clientX:d+1,clientY:a+1};this.simulateEvent(document,"mousemove",g);g={clientX:d+e,clientY:a+b};this.simulateEvent(document,"mousemove",g);this.simulateEvent(document,"mousemove",g);this.simulateEvent(f,"mouseup",g)},findCenter:function(a){var a=b(this.target),c=a.offset();
return{x:c.left+a.outerWidth()/2,y:c.top+a.outerHeight()/2}}});b.extend(b.simulate,{defaults:{speed:"sync"},VK_TAB:9,VK_ENTER:13,VK_ESC:27,VK_PGUP:33,VK_PGDN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40})})(jQuery);
var propInspector={el:null,mode:null,textPropMap:{textBold:{property:"font-weight",active:"bold",inactive:"normal",importAction:"checkbox"},textItalics:{property:"font-style",active:"italic",inactive:"normal",importAction:"checkbox"},textUnderline:{property:"text-decoration",active:"underline",inactive:"none",importAction:"checkbox"},textLeft:{property:"text-align",active:"left",importAction:"checkbox"},textCenter:{property:"text-align",active:"center",importAction:"checkbox"},textRight:{property:"text-align",
active:"right",importAction:"checkbox"},textColor:{property:"color",importAction:"textColor"},textSize:{property:"font-size",importAction:"select"},textFont:{property:"font-family",importAction:"select"},textOpacity:{property:"opacity",importAction:"slider"},textVerticalCenter:{property:"top",active:"50%",importAction:"checkbox"},textVerticalBottom:{property:"top",active:"100%",importAction:"checkbox"},textVerticalTop:{property:"top",active:"0%",importAction:"checkbox"},textTop:{property:"top",importAction:"slider"}},
shapePropMap:{shapeBackground:{controlCssProp:"background-color",property:"bgc",index:0},shapeBorder:{property:"b",controlCssProp:"background-color",index:1},shapeBorderStyle:{property:"border-style"},shapeBorderWidth:{property:"b",index:0},shapeBorderRadius:{property:"b",index:2},shapeOpacity:{property:"bgc"},shapeHeight:{cssProperty:"height",property:"tlwh",index:3},shapeWidth:{cssProperty:"width",property:"tlwh",index:2}},init:function(){propInspector.el=$("#propertyInspector")},widgetSelected:function(){propInspector.update()},
setPropMode:function(b,a){var c=$(".ui-selected").eq(0);c.attr("id")!=propInspector.modeWidgetId&&(b&&("text"==b||"shape"==b)?(propInspector.mode=b,propInspector.modeWidgetId=a):(propInspector.modeWidgetId=null,c=widget.get(c.attr("id")),propInspector.mode=c.b&&c.bgc||c.sc||!c.tc?"shape":"text"))},getPropMap:function(b){return propInspector[(b||propInspector.mode)+"PropMap"]},hide:function(){propInspector&&propInspector.el&&(propInspector.el.removeClass("open").hide(),$("#textPropertyInspector, #shapePropertyInspector").hide(),
propInspector.hideColorPickers(),propInspector.modeWidgetId=null)},position:function(){var b=$("#propertyInspectorBtn, #propertyInspectorBtn2").not(":hidden").position();b&&b.left&&propInspector.el.css({top:41,left:b.left-182})},show:function(b){var a=$("div[id^='propertyInspectorBtn']:visible");0<a.size()?(1==a.size()&&(b="shape","propertyInspectorBtn2"==a.attr("id")&&(b="text")),propInspector.setPropMode(b),propInspector.el.addClass("open"),propInspector.position(),propInspector.el.show(),"text"==
propInspector.mode?($("#textPropertyInspector").show(),$("#shapePropertyInspector").hide()):($("#textPropertyInspector").hide(),$("#shapePropertyInspector").show()),propInspector.importProps(null,propInspector.mode),propInspector.showShape()):propInspector.hide()},showShape:function(){var b=$(".ui-selected");!b.hasClass("backgroundWidget")&&"shape"==propInspector.mode?1<b.size()?(propInspector.disableWH(),propInspector.enableShapeOrnaments()):(propInspector.enableWH(),b=widget.get(b.attr("id")),!b.upload||
"y"!=b.upload?propInspector.enableShapeOrnaments():propInspector.disableShapeOrnaments()):b.hasClass("backgroundWidget")&&"shape"==propInspector.mode&&propInspector.enableBackgroundOnly()},update:function(){var b=$(".ui-selected").attr("id"),b=widget.get(b),a=$("#textPropertyInspector").is(":visible"),c=$("#shapePropertyInspector").is(":visible");a||c?!b.bgc&&!b.b&&!b.seg&&!b.upload?propInspector.show("text"):propInspector.show("shape"):propInspector.hide()},toggle:function(b){var a=propInspector.mode,
b=b.srcElement||b.target;if("menuExpander"==b.id)b="shape";else if("textMenuExpander"==b.id)b="text";else return;propInspector.setPropMode(b);propInspector.el.hasClass("open")?(propInspector.hide(),b!=a?(propInspector.importProps(null,b),propInspector.show(b)):propInspector.showShape()):(propInspector.importProps(null,b),propInspector.show(b));return!1},importProps:function(b,a){if(!b)var c=$(".ui-selected").eq(0),b=widget.get(c.attr("id"));var c=$("#"+c.attr("id")),d=propInspector.getPropMap(),e,
f;propInspector.setPropMode(a);if("text"==propInspector.mode){propInspector.el.find(".radio").removeClass("activeCheckbox");var g=$([]);$(".ui-selected").each(function(){g=g.add(widget.getSubTextElements($(this)))});if(0<g.size())for(property in d)if(d[property].importAction)propInspector[d[property].importAction+"PropImport"](b,d,property,g.eq(0))}else for(property in propInspector.el.find("#shapeOpacity").val(100).closest("tr").find(".sliderValue").text("100%"),d)if(e=propInspector.el.find("#"+
property),f=b,!b[d[property].property]&&b.segments&&b.segments.length&&(f=widget.get(b.segments[0].id)),d[property].controlCssProp&&f[d[property].property])e.css(d[property].controlCssProp,f[d[property].property][d[property].index]);else if(void 0!=d[property].property&&void 0!=d[property].index){var h=f[d[property].property],h=h?h[d[property].index]:0;("h"==f.r||"n"==f.r||!f.r)&&"shapeHeight"==property&&e.attr("disabled","disabled");("v"==f.r||"n"==f.r||!f.r)&&"shapeWidth"==property&&e.attr("disabled",
"disabled");"number"==e.attr("type")&&"string"===typeof h&&(h=(f=c.css(d[property].cssProperty))?parseFloat(f):0);e.val(h)}else if("shapeOpacity"==property){h=100;try{h=parseInt(100*utils.getRgbaAlpha(f[d[property].property][0]))}catch(i){}e.val(h).closest("tr").find(".sliderValue").text(h.toString()+"%")}d=propInspector.getPropMap("general");for(property in d)e=propInspector.el.find("#"+property),void 0!=d[property].property&&void 0!=d[property].index&&e.val(b[d[property].property][d[property].index])},
checkboxPropImport:function(b,a,c,d){b=propInspector.el.find("#"+c);d=d.find(".widgetText");d=d.css(a[c].property);d==a[c].active?b.addClass("activeCheckbox"):d==a[c].inactive&&b.removeClass("activeCheckbox")},textColorPropImport:function(b,a,c,d){b=propInspector.el.find("#"+c);d=d.find(".widgetText");a=d.css(a[c].property);b.css("background-color",a)},selectPropImport:function(b,a,c,d){b=propInspector.el.find("#"+c);d=d.find(".widgetText");0!=d.length&&(a=d.css(a[c].property),"'"==a[0]&&(a=a.split("'")[1]),
b.val(a))},sliderPropImport:function(b,a,c,d){b=propInspector.el.find("#"+c);d=d.find(".widgetText");a=parseFloat(d.css(a[c].property));1>=a&&(a=parseInt(100*a));b.val(a);b.closest("tr").find(".sliderValue").text(a.toString()+"%")},adjustOpacity:function(b,a,c){widget.getLockTos(c).each(function(){var b=$(this),c=b.attr("id"),f=widget.get(c);if(f.bgc){var g;b?b.find("canvas, img"):$("#"+c).find("canvas, img");if(f.bgc)for(var h=0;h<f.bgc.length;h++)g=utils.hex2rgba(f.bgc[h],a),g=utils.replaceRgbaAlpha(g,
a),f.bgc[h]=g;f.b&&(g=utils.hex2rgba(f.b[1],a),g=utils.replaceRgbaAlpha(g,a),f.b[1]=g);widget.set(f,c);widget._redraw(b,f)}})},exportProps:function(b,a,c){var d=c?$("#"+c):$(".ui-selected"),e=c?widget.get(c):widget.get(d.attr("id")),f=propInspector.getPropMap()[b];if(e.sc&&1<e.sc&&!widget.hasOwnColorProperties(e)){e.srps=!0;for(var g=0;g<e.segments.length;g++)propInspector.exportProps(b,a,e.segments[g].id)}if(-1<b.indexOf("text")){var h=$([]);d.each(function(){h=h.add(widget.getSubTextElements($(this)))});
for(g=0;g<h.size();g++){var d=$(h.eq(g)),c=d.attr("id"),e=widget.get(c),i=d.find(".widgetText");if(e.bgc&&e.ts){i.contents().wrapAll("<span></span>");var j=i.find("span").eq(0);j.height();j.attr("style",i.attr("style")).css("padding",0);d.width();j.width();d.height();j.height();j.width();j.height();j.contents().eq(0).unwrap()}a=f.unit?a+f.unit:a;parseInt(i.css("padding-top"));"top"==f.property&&1>=a&&(a=a.toString()+"%");if("font-size"==f.property){var j=i.css("font-size"),l=i.css("line-height");
i.css("font");i.css("font-style");j=Math.round(parseInt(l)-parseInt(j)+parseInt(a));i.css("font-size",parseInt(a)+"px");i.css("line-height",j+"px")}else i.css(f.property,a);d.hasClass("ui-selected")&&widget.verticalAlign(d);e.ts=i.attr("style");widget.set({ts:i.attr("style")},c)}}else if(-1<b.indexOf("Opacity"))for(g=0;g<d.length;g++)f=widget.get(d.eq(g).attr("id")),propInspector.adjustOpacity(f,a,d.eq(g),d.eq(g).attr("id"));else if(-1<b.indexOf("shape")){i=f.property;j=f.index;l=1;if(("shapeBackground"==
b||"shapeBorder"==b)&&e.bgc)l=utils.getAlphaFromColor(e.bgc[0]);if(void 0!=i&&void 0!=j)for(g=0;g<d.length;g++){d.eq(g).find("canvas, img");e=widget.get(d.eq(g).attr("id"));c||(e=widget.get(d.eq(g).attr("id")));if(null==e[i]&&"b"==i)var k=propInspector.getBorderValue(e,a,j,d.eq(g));null==e[i]&&!1==k&&(e.b=[0,"#999999",0],storage.set(d.eq(g).attr("id"),e));if("undefined"!==typeof e[i])if("tlwh"==i)propInspector.resizeWidget(f,a,d.eq(g));else{if("b"==i&&e.segment)for(var b="b,bs,bts,bls,bms,bbs,brs".split(","),
n=0;n<b.length;n++){var m=e[b[n]];m&&(m[j]=a,1<j&&m.splice(3,3))}else e[i][j]=a;widget.set(e,d.eq(g).attr("id"));var p;e.segments?p={mode:"all"}:e.segment&&(p={mode:"seg",segId:c});widget._redraw(d.eq(g),e,p)}1!=l&&propInspector.adjustOpacity(e,l,d.eq(g),d.eq(g).attr("id"))}}},resizeWidget:function(b,a,c,d){if((d=d?d:storage.get(c.attr("id")))&&"a"==d.tlwh[b.index])d.tlwh[b.index]="100%",widget.set(d,c.attr("id"));c.css(b.cssProperty,a);b=[parseInt(c.css("top")),parseInt(c.css("left")),c.width(),
c.height()];null==d.segment&&(widget._resize(c,null,b),widget._resize(c,null,b))},toggleCheckboxStyle:function(){$(this).toggleClass("activeCheckbox");var b=propInspector.getPropMap(),b=$(this).hasClass("activeCheckbox")?b[this.id].active:b[this.id].inactive;propInspector.exportProps(this.id,b)},toggleRadioStyle:function(){var b=propInspector.getPropMap();$(this).addClass("activeCheckbox").siblings(".radio").removeClass("activeCheckbox");propInspector.exportProps(this.id,b[this.id].active)},togglehozontalAlignment:function(){var b=
propInspector.getPropMap();$(this).addClass("activeCheckbox").siblings(".hozontalAlignment").removeClass("activeCheckbox");propInspector.exportProps(this.id,b[this.id].active)},colorPicked:function(b){this.css("background-color",b);propInspector.exportProps(this.attr("id"),b)},selectChanged:function(){if(0!=$(this).val().length){var b="number"==$(this).attr("type")?parseInt($(this).val()):$(this).val();propInspector.exportProps(this.id,b);updateTLWH()}},sliderChanged:function(){var b=$(this).val()+
"%";$(this).closest("tr").find(".sliderValue").text(b);propInspector.exportProps(this.id,$(this).val()/100)},disableWH:function(){$("#shapeSizeProperties input").attr("disabled","true")},enableWH:function(){$("#shapeSizeProperties input").removeAttr("disabled")},disableShapeOrnaments:function(){$("#shapeMainProperties input").attr("disabled","true");propInspector.enablePickers(!1,$("#shapeMainProperties .color-picker-trigger"))},enableShapeOrnaments:function(){$("#shapeMainProperties input").removeAttr("disabled");
propInspector.enablePickers(!0,$("#shapeMainProperties .color-picker-trigger"))},enableBackgroundOnly:function(){propInspector.disableShapeOrnaments();propInspector.disableWH();propInspector.enablePickers(!0,$(".backgroundWidget .color-picker-trigger"))},enablePickers:function(b,a){b?$.each(a,function(a,b){0<$(b).siblings(".mask").size()&&$(b).unwrap().siblings(".mask").detach()}):$.each(a,function(a,b){0==$(b).siblings(".mask").size()&&$(b).wrap("<div></div>").parent("div").css("position","relative").append('<div class="mask"></div>').find(".mask").width(22).height(22).css({position:"absolute",
right:0,"background-color":"#bfbfbf",opacity:0.5})})},hideColorPickers:function(){if(!propInspector.colorPickers||3>propInspector.colorPickers.length)propInspector.colorPickers=$(".color-picker");propInspector.colorPickers.hide()},hideEditableCombo:function(){if(!$("#ufd-container .list-wrapper").hasClass("invisible")){$("#ufd-container .list-wrapper").addClass("invisible");var b=$("#ufd-textSize");b.val(parseInt(b.val(),10)+"px");$("#textSize").eq(0).val(b.val()).change()}},getBorderValue:function(b,
a,c,d){var e=!1,f="b,bts,bls,brs,bbs,bms".split(",");for(type in f)null!=b[f[type]]&&(b[f[type]][c]=a,widget.set(b,d.attr("id")),widget._redraw(d,b),e=!0);return e}},contextMenu={dragStart:function(){$("#contextMenuItems").toggleClass("locked").data("preventClick",!0)},dragStop:function(){setTimeout(function(){$("#contextMenuItems").data("preventClick",!1)},1)},linkClickDragStart:function(b){var a=$("#cmLink").data("lastClicked")||0;(new Date).getTime()>a+600&&$("#cmLink2").simulate("mousedown").simulate("mousemove",
{clientX:b.clientX,clientY:b.clientY});$("#cmLink").data("lastClicked",(new Date).getTime());return!1},toggleReplace:function(){},place:function(b){var a=$(".ui-selected");if("hide"==b||0==a.length)return contextMenu.hide(),!0;!1!==$("#contextMenuItems").data("open")&&contextMenu.open();if($("#contextMenuItems").hasClass("locked")||"dontMovePosition"==b){var b=parseFloat($("#contextMenuItems").css("left")),c=parseFloat($("#contextMenuItems").css("top")),d=utils.getTLWH("#viewport");if(b<d.width-40&&
c<d.height-40)return $("#contextMenu2").show(),!0}a=widget.getRoots(a);a=utils.getBoundingArea(a);$("#contextMenu2").show().find("#contextMenuItems").addClass("trans150").css({top:a.top-47,left:a.right+16});setTimeout(function(){$("#contextMenuItems").removeClass("trans150");propInspector.position()},160)},hide:function(){$("#contextMenu2").hide();propInspector.hide()},open:function(){var b=widget.getRoots(".ui-selected").length,a=-41,c=-41,d=0,e=42;$(".subExpander").not(".open").css({top:""}).hide();
var f=$(".ui-selected");$("#contextMenuItems .cm").each(function(){$this=$(this);$this.hide();if(1==b&&$this.hasClass("multiSelectOnly")||$this.hasClass("multiSegmentOnly")&&!widget._isMultiSegment(f.attr("id"))||$this.hasClass("zAlignOnly")&&(!f.hasClass("rootWidget")||f.hasClass("backgroundWidget"))||$this.hasClass("replaceGroupOnly")||$this.hasClass("duplicatableOnly")&&f.hasClass("backgroundWidget"))return!0;var g=widget.get(f.attr("id"));if(!g.bgc&&!g.b&&!g.seg&&!g.upload&&$this.hasClass("backgroundBorderOnly")||
!widget.containsText(f)&&$this.hasClass("textOnly"))return!0;$this.show();$this.hasClass("up")&&($this.css({top:a}),a-=37);$this.hasClass("left")&&($this.css({left:c}),c-=37);$this.hasClass("down")&&($this.css({top:d}),d+=37);$this.hasClass("right")&&($this.css({left:e}),e+=37)});$("#contextMenuItems").data("open",!0)},close:function(){$("#contextMenuItems div, #contextMenuItems a").not(".up, #hint").css({left:0,top:0});$("#contextMenuItems").data("open",!1);$(".subExpander").removeClass("open");
contextMenu.closeSubmenu($(".subExpander"));propInspector.hide()},markAsLastClicked:function(){$(this).siblings().not(".subExpander").removeClass("lastClicked");$(this).addClass("lastClicked")},toggleSubmenu:function(){$(this).hasClass("open")?contextMenu.closeSubmenu(this):contextMenu.openSubmenu(this);return!1},openSubmenu:function(b){$(b).addClass("open");var a=0;$(b).parent().children().removeClass("hidden").each(function(){$(this).css("top",a);a+=35});$(b).parent().css("height",a-29)},closeSubmenu:function(b){$(b).removeClass("open").css("top",
"");$(b).siblings().css("top",0).not(".lastClicked").addClass("hidden");$(b).parent().css("height","");$(b).hide()},toggle:function(){if(!0==$("#contextMenuItems").data("preventClick"))return!1;$("#contextMenuItems").data("open")?contextMenu.close():contextMenu.open()},cmZAlign2:function(b){var a=b.target.id,c=null;widget.getRoots(".ui-selected").each(function(){obj=$(this);var b=$('[data-lockto="'+obj.attr("id")+'"]');c=obj.parent();if("cmFront"==a)b.detach().appendTo(c);else if("cmBack"==a)0<c.find(".backgroundWidget").length?
b.detach().insertAfter(c.find(".backgroundWidget")):b.detach().prependTo(c);else if("cmFrontOne"==a){var e=obj.nextAll(".rootWidget").not(".ui-selected").first();if(0==e.length)return!1;e=$('[data-lockto="'+e.attr("id")+'"]').last();b.detach().insertAfter(e)}else if("cmBackOne"==a){e=obj.prevAll(".rootWidget").not(".ui-selected").not(".backgroundWidget").first();if(0==e.length)return!1;e=$('[data-lockto="'+e.attr("id")+'"]').first();b.detach().insertBefore(e)}});null!=c&&page.orderWidgets(c);return!1},
cmAlign:function(b){var a=b.target.id,b=widget.getRoots(".ui-selected"),c=utils.getBoundingAreaRelative(b);b.each(function(){var b=null,e=null;switch(a){case "cmAlignLeft":b=parseFloat($(this).css("left"))-c.left;break;case "cmAlignCenter":b=parseFloat($(this).css("left"))+parseFloat($(this).outerWidth())/2-(c.left+c.right)/2;break;case "cmAlignRight":b=parseFloat($(this).css("left"))+$(this).outerWidth()-c.right;break;case "cmAlignTop":e=parseFloat($(this).css("top"))-c.top;break;case "cmAlignMiddle":e=
parseFloat($(this).css("top"))+$(this).outerHeight()/2-(c.bottom+c.top)/2;break;case "cmAlignBottom":e=parseFloat($(this).css("top"))+$(this).outerHeight()-c.bottom;break;default:return!1}if(0===b&&0===e)return!0;var f=$('[data-lockto="'+$(this).attr("id")+'"]');widget.get($(this).attr("id"));f.each(function(){var a=widget.get($(this).attr("id")),a=$.extend([],a.tlwh);if(null!=b){var c=parseFloat($(this).css("left"))-b;$(this).addClass("trans150").css("left",c);-1==a[1].toString().indexOf("%")&&$(this).attr("id")==
$(this).attr("data-lockto")&&(a[1]=c,widget.set({tlwh:a},$(this).attr("id")))}null!=e&&(c=parseFloat($(this).css("top"))-e,$(this).addClass("trans150").css("top",c),-1==a[0].toString().indexOf("%")&&$(this).attr("id")==$(this).attr("data-lockto")&&(a[0]=c,widget.set({tlwh:a},$(this).attr("id"))))})});setTimeout(function(){$(".trans150").removeClass("trans150")},160);return!1}},canvas2={mousewheel:function(b,a){if(!$("#canvas").data("zooming")){if(0>a)return 1==project.get("currentZoom")&&null==widget._dragSelection&&
canvas2.zoom({newZoom:"auto",centerY:b.pageY,centerX:b.pageX}),!1;var c=project.get("currentZoom"),d=page.atCanvasXY(b.pageX,b.pageY);1!=c&&d&&$(d).trigger("click")}},zoom:function(b){$("#canvasPages").zoom(b)},zoomOut:function(){var b=utils.getCenterPoint("#viewport");canvas2.zoom({newZoom:"auto",centerY:b.left,centerX:b.top})},setContainment:function(){var b=utils.getTLWH("#viewport"),a=utils.getTLWH("#canvas");return[b.left+b.width-a.width-10,b.top+b.height-a.height-10,b.left+10,b.top+10]},setScreenContainment:function(){var b=
$(".screen");if(0!=b.length){var a=utils.getTLWH("#canvas"),c=project.get("currentZoom");b.each(function(){var b=utils.getTLWH(this);containment=[a.left,a.top,a.left+Math.floor(a.width)-b.width*c,a.top+Math.floor(a.height)-b.height*c];$(this).draggable("option","containment",containment)})}},dragStart:function(){if($("#canvas").data("zooming"))return!1;contextMenu.place("hide");1==project.get("currentZoom")&&$("#canvasLinks").hide()},drag:function(){},dragStop:function(){1!=project.get("currentZoom")&&
project.set({canvasPosY:parseInt($("#canvas").css("top")),canvasPosX:parseInt($("#canvas").css("left"))});canvas2.setScreenContainment();$("#canvasLinks").fadeIn(200)}},account={syncPending:{},lastActivity:(new Date).getTime(),safetyInterval:6E4,alerts:{projectLimitHit:{onAddActive:$("#tmplAlertProjectLimit_OnAddActive").tmpl({}),onDropToInactive:$("#tmplAlertProjectLimit_OnDropToInactive").tmpl({}),onOpenInactive:$("#tmplAlertProjectLimit_OnOpenInactive").tmpl({}),onExportNonSignedIn:$("#tmplAlertExportNonPremium").tmpl({})}},
checkIntegrity:function(){var b=account.get("id");if(b=storage.get(b)){if(null==account.get("loggedIn")){var a="New"==account.get("accType")?"no":"yes";account.set({loggedIn:a})}if((a=b.projectIds)&&0!=a.length)-1==$.inArray(b.lastOpenProject,a)&&account.set({lastOpenProject:a[0]}),account.get("maxActiveProjects")||account.set({maxActiveProjects:1}),account.get("maxPages")||account.set({maxPages:10}),account.get("upgradeDate")||account.set({upgradeDate:"0000-00-00 00:00:00"}),account.get("lastPaymentDate")||
account.set({lastPaymentDate:"0000-00-00 00:00:00"}),account.get("nextPaymentDate")||account.set({nextPaymentDate:"0000-00-00 00:00:00"}),account.get("lastPaymentResult")||account.set({lastPaymentResult:"s"})}},get:function(b){if(!storage.get("accounts")){if(!localStorage)return null;throw"No get account object for "+b+"Caller: "+arguments.callee.caller+" Second level:"+arguments.callee.caller.caller+"loadSate"+loading_Stage_Check;}var a=storage.get("accounts").last;if("currentUserId"==b||"id"==b)return a;
a=storage.get(a);return null==a||null==a[b]?null:a[b]},set:function(b){var a=account.get("currentUserId"),c=storage.get(a);if(null==c)throw"No set account object for "+b+"Caller:"+arguments.callee.caller+" Second level:"+arguments.callee.caller.caller+"loadSate"+loading_Stage_Check;for(var d in b)c[d]=b[d];storage.set(a,c)},changeAccountId:function(b,a){var c=storage.get("accounts"),d=storage.get(b);c.user[0].id=a;c.last==b&&(c.last=a);storage.set("accounts",c);storage.set(a,d);storage.remove(b)},
setup:function(){storage.set("accounts",{last:null,user:[]})},createUser:function(b){var a={email:"New",accType:"New",name:"",libraryWidth:423,loggedIn:"no",maxActiveProjects:1,maxPages:10,projectIds:account.get("projectIds")||[],uploads:account.get("uploads")||[],lastOpenProject:account.get("lastOpenProject")||""};if(0==arguments.length)var c=utils.guid("u");else c=b.accountId,a.accName=b.accName,a.accType=b.accType,a.email=b.email,a.loggedIn="yes";var d={id:c},e=storage.get("accounts");if(null!=
e)return e.user.push(d),e.last=c,storage.set("accounts",e),storage.set(c,a),c},login:function(b){if("login"!=b.a||"s"!=b.r)return account.drawSignup(b),!1;$("#saveNowButton").fadeOut(400);if(1!=account.get("projectIds").length)return!1;var a=account.get("currentUserId");account.createUser(b);var c=storage.get("accounts");2==c.user.length&&c.user[0]==a&&c.user.splice(0,1);account.set({loggedIn:"yes",accName:b.accName,accType:b.accType,maxActiveProjects:b.maxActiveProjects,maxPages:b.maxPages,upgradeDate:b.upgradeDate,
lastPaymentDate:b.lastPaymentDate,lastPaymentResult:b.lastPaymentResult,nextPaymentDate:b.nextPaymentDate});storage.remove(a);account.draw(b);fluidMenu.allowNewProjects();$("#msgLoadingAfterLogin").show();setTimeout(function(){account.sync(b.objects,!0)},500);fluidMenu.setButtonStyle($("#startMenu"),!0);$("#previewSignup").hide();$("#previewShare").show();preview.updateScrollbar();tracker.record("login",10,"","")},sync:function(b,a){$.isFunction(a)&&(a=void 0);for(var c=[],d=[],e=0;e<b.length;e++){var f=
b[e];switch(f.id.substr(0,1)){case "p":c.push(f.id);break;case "i":d.push(f.id)}}0<c.length&&($("#projectList, #inactiveProjectList").addClass("loading"),$("#projectsLoading").show(),ajax.syncDown(c,a,function(a,b,c){a=JSON.parse(c.responseText).t;$.isArray(a)||(a=[a]);for(c=b=0;c<a.length;c++){try{var e=JSON.parse(a[c])}catch(f){continue}"undefined"!=typeof e.uploads&&delete e.uploads;for(var k in e){var n=e[k];switch(k.substr(0,1)){case "p":account.addProjectId(k),b++}storage.set(k,n)}}0<b&&(project.isEmpty()&&
(project.sort(),e=account.get("lastOpenProject"),k=account.get("projectIds"),k.splice($.inArray(e,k),1),storage.remove(e),account.set({lastOpenProject:""}),0<k.length&&project.open(project.getLatestActiveProject()||k[k.length-1])),project.load());$("#projectList, #inactiveProjectList").removeClass("loading");$("#projectsLoading").hide();account.syncUploads(d)}))},syncUploads:function(b){function a(){$("#msgLoadingAfterLogin").hide();var a=$("#widgetGroupTitle").text();"Uploads"==a&&lib.draw(a)}if(!b||
0==b.length)return a(),!0;ajax.syncDown(b,function(b,d,e){b=JSON.parse(e.responseText).t;$.isArray(b)||(b=[b]);for(d=0;d<b.length;d++){try{var f=JSON.parse(b[d])}catch(g){continue}account.addUploadId(f.id,!0);try{var h=$.extend({font:"",color:"",upload:"y",g:["Uploads"],t:["Uploads"],data:f.id,wh:[f.width,f.height],title:f.name},f);delete h.name;delete h.width;delete h.height;storage.set(f.id,h);widgets.summary[f.id]=h}catch(i){}}a()})},register:function(b){if(b&&"s"==b.r)account.set({email:b.email,
accType:b.accType,accName:b.accName,loggedIn:"yes",accType:b.accType,accName:b.accName,maxActiveProjects:b.maxActiveProjects,maxPages:b.maxPages,upgradeDate:b.upgradeDate,lastPaymentDate:b.lastPaymentDate,nextPaymentDate:b.nextPaymentDate,lastPaymentResult:b.lastPaymentResult}),b.accountId!=account.get("id")&&account.changeAccountId(account.get("id"),b.accountId),account.draw(b),fluidMenu.allowNewProjects(),$("#saveNowButton").fadeOut(400);else return!1;$("#previewSignup").is(":visible")&&preview.signupComplete()},
draw:function(b){$("#profile").empty();$("#tmplAccount").tmpl(b).appendTo("#profile");$("Free"==b.accType?"#tmplCC1":"#tmplPremium").tmpl({}).appendTo("#upgradeHolder")},drawSignup:function(b){var a={index:1,uid:account.get("currentUserId"),email:"",instanceId:g_instanceId};b&&(a.email=b.email,a.error=b.t,a.checked="checked");$("#profile").empty();$("#previewSignupForm").empty();$("#tmplCreate").tmpl(a).appendTo("#profile");a.index=2;$("#tmplCreate").tmpl(a).appendTo("#previewSignupForm");b&&(b=$("#profile"),
setValid(b.find("[type=email]")),setValid(b.find("[type=checkbox]")),setFocus(b.find("[type=password]")))},isBrandNewUser:function(){if(!storage.get("accounts"))return!0;var b=account.get("id");return!b?!0:!storage.get(b)?!0:!1},checkEmailExists:function(b){$("form.createForm");ajax.syncUp({email:b},"emailRegd",null)},emailChecked:function(b){var a=$("form.createForm"),b=JSON.parse(b);!0===b.t||"true"===b.t?a.data("existing",!0).find("input[type=submit]").attr("value","Welcome back - Sign In"):a.data("existing",
!1).find("input[type=submit]").attr("value","Create Account")},addProjectId:function(b){var a=account.get("projectIds");try{a.push(b)}catch(c){}account.set({projectIds:a})},addUploadId:function(b,a){var c=account.get("uploads");c.push({id:b,s:Boolean(a)});account.set({uploads:c})},uploadSynced:function(b,a){for(var c=account.get("uploads"),d=0,e=c.length;d<e;d++){var f=c[d];if(f.id==b){f.s=Boolean(a);account.set({uploads:c});break}}},findUpload:function(b){for(var a,c=account.get("uploads"),d=0;d<
c.length;d++)if(b==c[d].id){a={index:d,upload:c[d]};break}return a},removeUpload:function(b){var a=this.findUpload(b);if(a){delete widgets.summary[b];var c=account.get("uploads");c.splice(a.index,1);account.set({uploads:c});storage.remove(b);ajax.apiCall("img","delete",b);$("#libraryWidgetDragging").remove();$("#"+b).remove();0>=c.length&&lib.draw("Uploads")}$("#trash").removeClass("droppableStyle")},startUpgrade:function(){var b="fluidMenu";0<$(this).parents(".messages").length&&(b="Notification");
tracker.record("openUpgradePanelVia"+b,1);account.displayAccountFrame("upgrade/")},upgradeSuccess:function(b){if("upgrade"==b.a&&"s"==b.r){account.set({accName:b.accName,accType:b.accType,maxActiveProjects:b.maxActiveProjects,maxPages:b.maxPages,upgradeDate:b.upgradeDate,lastPaymentDate:b.lastPaymentDate,lastPaymentResult:b.lastPaymentResult,nextPaymentDate:b.nextPaymentDate});var a=account.get("id"),a=storage.get(a);account.draw(a);tracker.record("UpgradeSucces",1);project.activeProjectCount()>b.maxActiveProjects&&
project.load()}},recoverPassword:function(){account.displayAccountFrame("recoverPassword/")},displayAccountFrame:function(b){var a=$("#accountFrame");if(a.attr("src")!=b)return a.attr("src",b),!1;a.get(0).contentWindow.reset&&a.get(0).contentWindow.reset();a.fadeIn(300);return!1},logout:function(b){page.detachFrame();for(var a=account.get("email"),c=account.get("uploads"),d=0;d<c.length;d++)delete widgets.summary[c[d].id];fluidMenu.setButtonStyle($("#startMenu"),!1);project.close();storage.clear();
account.setup();account.createUser();account.set({currentUserId:null,projectIds:[],uploads:[]});c=project.add(b,"New Project");account.drawSignup();project.load();project.open(c);$("#previewShare").hide();fluidMenu.allowNewProjects(!1);account.set({loggedIn:"no"});account.set("uploads",[]);lib.draw($("#widgetGroupTitle").text());notification.removeAll();tracker.record("closeSession",10,a,b);return!1},recordActivity:function(){var b=(new Date).getTime();b-account.lastActivity>account.safetyInterval&&
account.validateState();account.lastActivity=b},validateState:function(){if("yes"!=account.get("loggedIn")||"true"==g_imgFullCanvas)console.log("  Not logged in");else return ajax.syncUp({instanceId:g_instanceId},"accountState",account.get("id")),!0},requireRefresh:function(b){if("accountState"!=b.a||"s"!=b.r)return!1;"refresh"!=b.clientAction&&("logout"==b.clientAction?(account.logout(),localStorage.setItem("postloadMessage","serverLogout"),localStorage.setItem("restoreMyInstanceId","true"),location.reload()):
"warnClose"==b.clientAction&&(localStorage.setItem("postloadMessage","tab"),location.reload()))}},upload={w:null,h:null,uploadCount:0,hide:function(){$("#dropzone").fadeOut(200)},create:function(b,a){tracker.record("ImageUploaded",1);var c=new Image;c.onload=function(){a.width=this.width;a.height=this.height;a.src=this.src;upload.saveFile(a,upload.saveFileCallback,upload.saveFileCallback)};c.src=b},init:function(){document.addEventListener("dragenter",upload.enter,!1);document.addEventListener("dragover",
upload.over,!1);document.addEventListener("dragleave",upload.leave,!1);document.addEventListener("drop",upload.drop,!1)},enter:function(b){if("yes"!=account.get("loggedIn"))return!1;b=b.dataTransfer;(b.files&&0<b.files.length||"Files"==b.types)&&$("#dropzone").not(":visible")&&0==$(".pageWidget textarea").length&&$("#dropzone").fadeIn(200);return!1},over:function(b){utils.prevent(b)},leave:function(b){utils.prevent(b);0==b.pageX&&upload.hide()},drop:function(b){b.preventDefault&&b.preventDefault();
var a=b.dataTransfer.files;upload.uploadCount=b.dataTransfer.files.length;for(var b=0,c;c=a[b];b++)upload.readFile(c);upload.hide();return!1},readFile:function(b){if("yes"!=account.get("loggedIn"))return notification.add("alert","Please log in or sign up to upload images"),!1;if(upload.isValid(b))if(window.FileReader){var a=new FileReader;a.onerror=function(){};a.onload=function(a){return function(b){b.target.readyState==FileReader.DONE&&upload.create(b.target.result,a)}}(b);a.readAsDataURL(b)}else upload.uploadFile(b)},
uploadFile:function(b){upload.isValid(b)&&upload.saveFile(b,upload.saveFileCallback,upload.saveFileCallback);return!0},saveFileCallback:function(){upload.uploadCount--;var b="Uploads"==$("#widgetGroupTitle").text();0>=upload.uploadCount&&b&&(lib.draw("Uploads"),lib.scrollBottom())},uploadByClick:function(b){upload.uploadCount=this.files.length;for(var a=0,c=this.files.length;a<c;a++)upload.uploadFile(this.files[a]);b.preventDefault()},saveFile:function(b,a,c){if("yes"!=account.get("loggedIn"))return notification.add("alert",
"Please log in to upload images"),!1;var d=b.name,e=utils.guid("i"),f=b.width,g={title:d,font:"",color:"",type:b.type,upload:"y",r:"y",g:["Uploads"],t:["Uploads"],wh:[b.width,b.height]};storage.set(e,g);widget.saveTempFile(e,b);account.addUploadId(e);"New"!=account.get("accType")&&ajax.apiCall("img","post",e,b,function(b){widgets.summary[e]=g;f!=b.width&&(g.wh=[b.width,b.height],storage.set(e,g));widget.removeTempFile(e);$.isFunction(a)&&a(e)},function(){notification.add("alert","Unable to upload the file [ "+
b.name+" ].  Please only upload image files.");$.isFunction(c)&&c(e)});return e},bundle:function(b){storage.get(b)},isValid:function(b){var a=!0;b.type.match(/image.*/)||(a=!1,notification.add("alert","The file [ "+b.name+" ] is not an image.  Please only upload image files."));return a}},link={mouseTimeoutForHover:!1,showahrefs:function(b){b&&(new Date).getTime()-link.mouseTimeoutForHover<b?setTimeout(link.showahrefs,300,[b]):$(".linkTemplate").stop(!0,!0).delay(500).fadeOut(400)},hoverIn:function(b){if(!project.readOnly()){$(this).find(".linkToggle").stop(!0,
!0).delay(200).fadeTo(200,1);var a=$(this).parents("#canvasLinks"),c=$(this).detach();a.append(c);var d=link.comesFrom($(this).attr("id")),c=link.goesTo($(this).attr("id")),a=$("#"+d);link.draw($(this),a,$("#"+c),"active");d=widget.getPageOf(d);if(1==project.get("currentZoom")){a.css("outline","3px solid rgba(25,163,255,1.0)");var b=$("#"+d),e=b.hasClass("active"),f=$("#"+c),c=b.find(".page"),d=parseInt(b.css("top"))+parseInt(a.css("top"))+parseInt(a.css("height"))/2,g=parseInt(b.css("left"))+parseInt(a.css("left"))+
parseInt(a.css("width"))/2,h=parseInt(f.css("top"))+parseInt(f.css("height"))/2,f=parseInt(f.css("left"))+parseInt(f.css("width"))/2,a=13,i=60;e||(i=0);var e=0,e=g<f?parseInt(b.css("left"))+parseInt(c.css("width"))+i:parseInt(b.css("left"))-i,j=(h-d)/(f-g)*(e-g)+d,l=parseInt(b.css("top"))-i,k=parseInt(b.css("top"))+parseInt(c.css("height"))+i;if(j<=l||j>=k)d<h?j=parseInt(b.css("top"))+parseInt(c.css("height"))+i:(j=parseInt(b.css("top"))-i-20,g<f&&(a=-20)),e=(j-d)/(h-d)*(f-g)+g;b=j-d;c=e-g;b=Math.sqrt(b*
b+c*c)+25;$(this).find(".linkToggle").css({"margin-left":b+"px","margin-top":a+"px"})}else(a=page.isLinked(c,d))&&b&&link.hoverIn.apply(document.getElementById(a),[!1]),$(this).find(".linkToggle").css("margin-left","")}},hoverOut:function(b){$(this).find(".linkToggle").hasClass("openLinkMenu")||$(".linkToggle").not(".openLinkMenu").stop(!0,!0).delay(1200).fadeTo(200,0);var a=link.comesFrom($(this).attr("id"));$("#"+a).css("outline","");var c=link.goesTo($(this).attr("id"));link.draw($(this),$("#"+
a),$("#"+c),"ahref");a=widget.getPageOf(a);(c=page.isLinked(c,a))&&b&&link.hoverOut.apply(document.getElementById(c),[!1]);return!1},closeMenu:function(){$(".openLinkMenu").removeClass("openLinkMenu");$(".linkMenu").hide();return!1},toggleMenu:function(){$(this).hasClass("openLinkMenu")&&link.closeMenu();$(".openLinkMenu").removeClass("openLinkMenu");$(this).addClass("openLinkMenu");$("body").bind("click.linkToggle",function(a){if(!(0<$(a.target).parents(".linkMenu").length))return $(".openLinkMenu").removeClass("openLinkMenu"),
$(".linkMenu").hide(),$("body").unbind("click.linkToggle"),utils.prevent(a)});var b=$(this).parents(".link").attr("id"),a=project.get("links"),b=$.inArray(b,a.linkCanvId);if(-1<b){var c=$(this).offset();$(".linkMenu .transitionSelector").find("[value='"+a.transType[b]+"']").attr("selected","selected");$(".linkMenu .linkTriggerSelector").find("[value='"+a.triggerType[b]+"']").attr("selected","selected");$(".linkMenu").css({top:c.top,left:c.left}).show()}return!1},changeTrigger:function(){$this=$(this);
var b=project.get("links"),a=$(".openLinkMenu").parents(".link").attr("id"),c=$this.find(":selected").attr("value"),a=$.inArray(a,b.linkCanvId);-1<a&&(b.triggerType[a]=c);project.save()},changeTransition:function(){$this=$(this);var b=project.get("links"),a=$(".openLinkMenu").parents(".link").attr("id"),c=$this.find(":selected").attr("value"),d;for(d in b.linkCanvId)if(b.linkCanvId[d]==a){b.transType[d]=c;break}project.set({lastTransition:c});project.save()},follow:function(){var b=project.get("currentZoom");
$(this).find(".linkToggle").hide();1==b&&0==$(".connectorHelper").length&&(b=link.goesTo($(this).attr("id")),$(".active").attr("id")==b&&(b=link.comesFrom($(this).attr("id")),b=$("#"+b).parents(".screen").attr("id")),b=$("#"+b),page.activate(b),zoomInAndCenterOnPage(b,1,1,300))},template:function(b,a){var c=$("#tmplLink").tmpl({id:b}).appendTo("#canvasLinks");"ahref"==a?c.fadeIn(400):c.addClass("linkTemplate");return c},dragStart:function(b,a){hint.show("draggingLink");if("boolean"==typeof a&&a||
!$(this).data("dragOnClickStarted")){contextMenu.hide();var c=project.get("currentZoom");$("#canvas").data("revertZoom",c);"cmLink2"==$(this).attr("id")&&link.remove(".ui-selected");dragZoom($(this))}a&&($(this).data("dragOnClickStarted",!0),$(".ui-draggable").not(this).not(".pageWidget").draggable("disable"));setZoomedOutActions()},drag:function(){link.draw($("#dragCanvas"),$(".zoomedOutSelected"),$(".connectorHelper"),"ahref")},dragStop:function(){link.draw($("#dragCanvas"),$(".zoomedOutSelected"),
$(".connectorHelper"),"ahref");dragZoomStop();$(this).data("dragOnClickStarted",!1);$(".ui-draggable").not(this).not(".pageWidget").draggable("enable");hint.show("end")},drawAll:function(b){var a=project.get("links"),c;for(c in a.linkOrigin)("all"==b||a.linkType[c]==b)&&link.draw($("#"+a.linkCanvId[c]),$("#"+a.linkOrigin[c]),$("#"+a.linkDest[c]),a.linkType[c])},update:function(b){var a=project.get("links"),c=[];b.each(function(){var b=$(this).attr("id"),d;for(d in a.linkOrigin)($("#"+a.linkOrigin[d]).closest(".screen").attr("id")==
b||a.linkDest[d]==b)&&c.push(d)});for(var d in c)b=c[d],link.draw($("#"+a.linkCanvId[b]),$("#"+a.linkOrigin[b]),$("#"+a.linkDest[b]),a.linkType[b])},draw:function(b,a,c,d){var e=link.getCanvasHeight(),f=link.getHeadHeight(),g=link.getPadding(),h=$(b).find("canvas");if(0==h.length||0==$(c).size())h=$("<canvas>");var i=project.get("currentZoom"),j,l,k=0,k=$(a).closest(".screen"),n=$(".page",$(k)),m=$(".page",$(c));if("ahref"==d&&$(c).hasClass("connectorHelper"))j=Math.floor(parseInt(k.css("top"))+parseInt($(a).css("top"))+
parseInt($(a).css("height"))/2)*i-5,a=Math.floor(parseInt(k.css("left"))+parseInt($(a).css("left"))+parseInt($(a).css("width"))/2)*i-5,l=Math.floor(parseInt($(c).css("top"))-parseInt($("#canvas").css("top"))+parseInt($(c).css("height"))/2)-5,c=Math.floor(parseInt($(c).css("left"))-parseInt($("#canvas").css("left"))+parseInt($(c).css("width"))/2)-5,k=-20;else if($(a).hasClass("pageWidget")&&1!=i)j=(parseInt(k.css("top"))+parseInt(n.css("height"))/2)*i,a=(parseInt(k.css("left"))+parseInt(n.css("width"))/
2)*i,l=(parseInt($(c).css("top"))+parseInt(m.css("height"))/2)*i,c=(parseInt($(c).css("left"))+parseInt(m.css("width"))/2)*i,k=70;else if($(a).hasClass("pageWidget")&&1==i)j=$("#viewport"),utils.getTLWH(j),j=parseInt(k.css("top"))+parseInt($(a).css("top"))+parseInt($(a).css("height"))/2-5,a=parseInt(k.css("left"))+parseInt($(a).css("left"))+parseInt($(a).css("width"))/2-5,l=(parseInt($(c).css("top"))+parseInt(m.css("height"))/2)*i,c=(parseInt($(c).css("left"))+parseInt(m.css("width"))/2)*i,k=70;else return null;
n=c-a;l-=j;var c=Math.sqrt(n*n+l*l),p=Math.asin(l/c);l=180/Math.PI*p;if(0<k){var k=Math.PI+p,p=parseInt(m.css("width"))/-2/Math.cos(k)*i,o=Math.sqrt(parseInt(m.css("width"))*parseInt(m.css("width"))+parseInt(m.css("height"))*parseInt(m.css("height")))/2*i;p<o?(k=p,0>n&&(k-=20/link.getCanvasScale())):(k=parseInt(m.css("height"))/-2/Math.sin(k)*i,0>k&&(k+=20),k=Math.abs(k))}0>n&&(l=180-l);i=e/2;m=e/2;b.css({top:j,left:a,width:c,height:e,"-webkit-transform-origin":m+"px "+i+"px","-moz-transform-origin":m+
"px "+i+"px","-webkit-transform":"rotate("+l+"deg)","-moz-transform":"rotate("+l+"deg)"});c-=k;1>c&&(c=1);h.css({width:c,height:e}).attr({width:c,height:e});b=h[0].getContext("2d");h=b.createLinearGradient(2,2,h.outerWidth(),2);"template"==d?(h.addColorStop(0,"rgba(78, 50, 78, 0.0)"),h.addColorStop(0.3,"rgba(78, 50, 78, 1.0)"),h.addColorStop(0.5,"#4E004E"),h.addColorStop(1,"#803280")):"active"==d?(h.addColorStop(0,"rgba(25,163,255,1.0)"),h.addColorStop(0.3,"rgba(25,163,255,1.0)"),h.addColorStop(0.5,
"rgba(25,163,255,1.0)"),h.addColorStop(1,"rgba(25,163,255,1.0)")):(1!=link.getCanvasScale()?(h.addColorStop(0,"rgba(1, 120, 160, 1.0)"),h.addColorStop(0.3,"rgba(1, 120, 160, 1.0)"),h.addColorStop(0.5,"rgba(1, 120, 160, 1.0)")):(h.addColorStop(0,"rgba(1, 160, 204, 0.1)"),h.addColorStop(0.3,"rgba(1, 160, 204, 0.7)"),h.addColorStop(0.5,"rgba(1, 140, 200, 1.0)")),h.addColorStop(1,"rgba(1, 120, 160, 1.0)"));b.fillStyle=h;b.beginPath();b.moveTo(0,g);b.lineTo(c-f,g);b.lineTo(c-f,1);b.lineTo(c-1,e/2);b.lineTo(c-
f,e-1);b.lineTo(c-f,e-g);b.lineTo(0,e-g);b.closePath();b.fill()},from:function(b){var a=project.get("links"),c;for(c in a.linkOrigin)if(a.linkOrigin[c]==b)return a.linkCanvId[c];return!1},goesTo:function(b){var a=project.get("links"),c;for(c in a.linkDest)if(a.linkCanvId[c]==b)return a.linkDest[c];return!1},comesFrom:function(b){var a=project.get("links"),c;for(c in a.linkOrigin)if(a.linkCanvId[c]==b)return a.linkOrigin[c];return!1},add:function(b,a,c){var d=project.get("links"),e=project.get("lastTransition"),
f;for(f in d.linkOrigin)if("template"==d.linkType[f]&&d.linkOrigin[f]==b&&d.linkDest[f]==a)return!1;$(".page","#"+a).addClass("linkDropSuccess");setTimeout(function(){$(".page","#"+a).removeClass("linkDropSuccess")},500);id=utils.guid("l");d.linkOrigin.push(b);d.linkDest.push(a);d.linkCanvId.push(id);d.linkType.push(c);d.transType.push(e);d.triggerType.push("tap");project.save();b=link.template(id,c,e);b.find(".linkToggle").show();return b},target:function(b){for(var a=project.get("links"),c=0;c<
a.linkCanvId.length;c++)if(a.linkCanvId[c]==b)return a.linkDest[c];return!1},load:function(b){for(var a in b.linkOrigin)link.template(b.linkCanvId[a],b.linkType[a],b.transType[a])},del:function(b){function a(a){$(a).remove()}function c(a){$(a).find(".templateContent").empty().show()}"object"===typeof b&&(b=$(".openLinkMenu").closest(".link").attr("id"));if(void 0==b)return!1;var d=project.get("links"),e;for(e in d.linkCanvId)if(d.linkCanvId[e]==b){b="#"+d.linkCanvId[e];$(b).fadeOut(450,a(b));"template"==
d.linkType[e]&&(b="#"+d.linkDest[e],$(b).find(".templateContent").fadeOut(450,c(b)));link.spliceOut(d,e);break}link.closeMenu();$("#canvas").click()},remove:function(b){var a=project.get("links");$(b).each(function(){function c(a){a.remove()}var d=$(this).attr("id"),e;for(e in a.linkOrigin){var f=$("#"+a.linkOrigin[e]).parents(".screen").attr("id");if(a.linkOrigin[e]==d||f==d||a.linkDest[e]==d){d=$("#"+a.linkCanvId[e]);d.fadeOut(450,c(d));link.spliceOut(a,e);link.remove(b);break}}})},spliceOut:function(b,
a){b.linkOrigin.splice(a,1);b.linkDest.splice(a,1);b.linkCanvId.splice(a,1);b.linkType.splice(a,1);b.transType.splice(a,1);b.triggerType.splice(a,1);project.save()},getCanvasHeight:function(){return 18/link.getCanvasScale()},getHeadHeight:function(){return 14/link.getCanvasScale()},getPadding:function(){return 7/link.getCanvasScale()},getCanvasScale:function(){return fullCanvas.currentScale}},lib={cached:{},fadeInSpeed:300,thumbPos:{},currentDisplay:"",drawTimeout:null,closed:function(){return $("#library").find("#tabLibrary").hasClass("closed")},
toggle:function(){var b=$("#library"),a=b.outerWidth(),c;c=b.find("#tabLibrary").hasClass("open")?-a:0;b.animate({left:c},a/3,function(){b.find("#tabLibrary").toggleClass("closed open");zoomInAndCenterOnPage($(".active"),1,1,300)})},show:function(b){var a=$("#library");if(lib.closed())a.show(),b&&$.isFunction(b)&&b();else if(0!=a.position().left||!a.is(":visible")){var c=account.get("libraryWidth");a.css({left:"-"+c+"px",display:"block",width:c});utils.animateRaf(function(b){a.css({left:c*(b-1)+"px"})},
lib.fadeInSpeed,"easeOutCubic",function(){0==a.children("#widgets").find(".thumb").height()&&lib.updateScrollbar();b&&$.isFunction(b)&&b()})}},showStepBegin:function(){var b=!lib.closed(),a=$("#library").data("showStepped",b);b?a.css({left:"-"+account.get("libraryWidth")+"px",display:"block",width:account.get("libraryWidth")}).show():a.fadeIn(lib.fadeInSpeed);return b},showStep:function(b){var a=$("#library");a.data("showStepped")&&(a.css({left:account.get("libraryWidth")*(b-1)}),1==b&&$("#library").data("showStepped",
!1))},resize:function(b,a){account.set({libraryWidth:a.size.width});var c=$("#canvasPages .active");1==c.length&&zoomInAndCenterOnPage(c,1,1,300);lib.updateScrollbar()},setHeaderHoverIn:function(){$(this).find("h6").stop(!0,!0).delay(300).fadeTo(200,1);setTimeout(function(){$(this).css("background","#ccc")},600)},setHeaderHoverOut:function(){$(this).find("h6").stop(!0,!0).hide();setTimeout(function(){$(this).css("background","rgba(205,205,205,0.0)")},600)},collapseSection:function(){var b=$(this).parents(".basicBG").attr("id"),
b=$("#"+b),a=b.children(".scrollbar").children(".track"),c=a.children(".thumb"),d=parseFloat(c.css("top"));$(this).hasClass("closed")?$(this).removeClass("closed").html("Hide"):$(this).addClass("closed").html("Show");$(this).parent("header").siblings("ol").toggleClass("hidden");$(this).parent("header").siblings(".hideButton").toggleClass("hidden");$(b).tinyscrollbar();a=d+c.height()-a.height();0>a&&(a=0);b.tinyscrollbar_update(d-a)},updateScrollbar:function(){$("#widgets").tinyscrollbar()},scrollBottom:function(){$("#widgets").tinyscrollbar_update("bottom")},
init:function(){for(var b={},a=0;a<widgets.g.length;a++){var c=widgets.g[a],d=b[c.s];d||(b[c.s]=d=[]);d.push(c)}var a=!1,e;for(e in b){$("#tmplGroupSection").tmpl({n:e,d:a}).appendTo("#widgetGroupSelect");d=b[e];for(a=0;a<d.length;a++)$("#tmplGroupSelect").tmpl(d[a]).appendTo("#widgetGroupSelect");a=!0}lib.draw(widgets.g[0].n);lib.currentDisplay=widgets.g[0].n;widget.addUploads()},changeSet:function(){if(!$(this).hasClass("librarySetActive")){var b=parseFloat($("#widgets").children(".scrollbar").find(".thumb").css("top")),
a=$(this).siblings(".librarySetActive").attr("data-for");lib.thumbPos[a]=b;b=$(this).attr("data-for");lib.draw(b);tracker.record("LibaryChange"+b,1);$("#widgets").tinyscrollbar_update(lib.thumbPos[b])}},_createDragHelper:function(){var b=$.extend(!0,{},widget.get($(this).attr("id")));b.wh=b.wh||[80,120];b.wh[0]="a"==b.wh[0]?"100%":b.wh[0];b.wh[1]="a"==b.wh[1]?"100%":b.wh[1];$("#canvasPages .active .widgetHolder").width();parseInt(b.wh[0]);b.wh[0]="string"===typeof b.wh[0]?$("#canvasPages .active .widgetHolder").width()*
parseInt(b.wh[0])/100:b.wh[0];b.wh[1]="string"===typeof b.wh[1]?$("#canvasPages .active .widgetHolder").height()*parseInt(b.wh[1])/100:b.wh[1];var a=b.st&&"b"==b.st?[0,0,80,120]:[0,0,b.wh[0],b.wh[1]],c=$("#tmplDraggingWidgetContainer").tmpl(b);"y"==b.upload&&c.addClass("upload");widget._drawFromRoot($(this).attr("id"),c.find(".widgetParts"),a,b);return c},dropdownChangeSet:function(b){var a=parseFloat($("#widgets").children(".scrollbar").find(".thumb").css("top"));lib.thumbPos[lib.currentDisplay]=
a;var c=$(b.target).text();setTimeout(function(){lib.draw(c);$("#widgets").tinyscrollbar_update(lib.thumbPos[c]);lib.currentDisplay=c;tracker.record("LibarySetChange"+c,1)},10);b.preventDefault();return!1},draw:function(b){function a(){g||(lib.cache(b),$("#libraryLoading").hide());lib.cached[b].appendTo(f);e?lib.cached[b].show():lib.cached[b].fadeIn(this.fadeInSpeed);search.filter();lib.drawTimeout=null}if(void 0===b||null===b)b=lib.currentDisplay;$("#widgetGroupTitle").text(b);var c=$("#library .librarySetActive").attr("data-for")||
lib.currentDisplay,d="uploads"==b.toLowerCase(),e=d&&"uploads"==c.toLowerCase(),f=$("#library .viewport");f.find(".overview").hide().remove();d&&lib.cached.hasOwnProperty(b)&&delete lib.cached[b];var g=lib.cached.hasOwnProperty(b);!g&&!e&&$("#libraryLoading").show();e?a():(lib.drawTimeout&&window.clearTimeout(lib.drawTimeout),lib.drawTimeout=window.setTimeout(a,10));return!1},cache:function(b){var a=$("#tmplLibOverview").tmpl(),c;for(c in widgets.t)$("#tmplWidgetSection").tmpl({title:widgets.t[c]}).appendTo(a);
for(c in widgets.summary){var d=widgets.summary[c];if(d.g&&-1!=d.g.indexOf(b)){var e=$.extend(!0,{},d),d=$.extend(!0,{},d),f;for(f in e.t){var g=a.find("#widgetGroup"+e.t[f]),h=$("#tmplLibraryWidgetContainer").tmpl({id:c,title:e.title}),i=h.find(".widgetParts"),j=e.wh?$.extend([],e.wh):[320,480];if("string"===typeof j[0]||"string"===typeof j[1])e.wh[0]="string"===typeof e.wh[0]?320:e.wh[0],e.wh[1]="string"===typeof e.wh[1]?480:e.wh[1],j=[e.wh[0],e.wh[1]];widget.scale(i,d);widget._drawFromRoot(c,i,
[0,0,j[0],j[1]],e);h.appendTo(g);"y"==e.upload&&h.addClass("upload")}}}"Uploads"==b&&("yes"==account.get("loggedIn")?$("#tmplUpload").tmpl().appendTo(a):$("#tmplUploadDisabled").tmpl().appendTo(a),a.find("#widgetGroupUploads img").load(function(){var a=$(this),b=a.closest(".libraryWidget").attr("id"),b=widgets.summary[b];if(!b.wh[0]||!b.wh[1])a.css({height:"auto",width:"auto"}),b.wh=[a.width(),a.height()],a.closest(".pageWidget").css({width:b.wh[0],height:b.wh[1]}),widget.scale(a.closest(".widgetParts"),
b),a.css({height:"100%",width:"100%"})}),a.find("#widgetGroupUploads canvas").load(function(){}));$(a).find(".setHeader").each(function(){$(this).children("ol").html().length==0&&$(this).remove()});lib.cached[b]=a},toggleUploads:function(){if($(this).hasClass(".open"))$(this).removeClass(".open"),$(this).html("Open Upload"),$("#category").fadeIn(),lib.draw(lib.currentDisplay),$("#widgets").tinyscrollbar_update(lib.thumbPos[lib.currentDisplay]);else{var b=parseFloat($("#widgets").children(".scrollbar").find(".thumb").css("top"));
lib.thumbPos[lib.currentDisplay]=b;$(this).addClass(".open");$(this).html("Close  Upload");$("#category").fadeOut();lib.draw("Uploads")}},esc:function(){$("#previewPage").parent("#previewHolder").hasClass("open")?preview.close():$("#canvas").hasClass("canvas100")?canvas2.zoomOut():$("#accountFrame").fadeOut()}},qrCode={urlbase:"https://chart.googleapis.com/chart?cht=qr",setURL:function(b,a,c){var d=this.urlbase+"&chl="+encodeURIComponent(b),d=d+("&chs="+a+"x"+a),b=c?c:b;$("#qrHolder").html('<img src="'+
d+'" title="'+b+'">')}},hint={hints:{createPage:"Double-click to create pages",createAnotherPage:"Create another page",editPage:"Click a page to edit",library:"Drag widgets here",libraryDoubleClick:"Double-click widgets in the library to place here",Zoomout:"Click to zoom out",link:"Click link button to link pages",draggingLink:"Drop the link on another page"},linkShowCount:3,currentLocation:!1,show:function(b,a){var c=$("#hint");0==c.length&&(c=$("#tmplHint").tmpl());if(!project.readOnly()||"createPage"==
b){if("createPage"==b){var d=function(){hint.cleanup();setTimeout(function(){hint.show("createAnotherPage")},200)};$("#hint").fadeOut(300);setTimeout(function(a){a=project.get("name")+(project.readOnly()?"":"<br>"+a);c.detach().html(a).prependTo("#canvas").fadeIn(400);hint.position("center");project.readOnly()||($("#canvas").bind("dblclick.msg",function(){d()}),$("#createNewPageButton").bind("click.msg",function(){d()}))},310,hint.hints[b])}else if("createAnotherPage"==b){c.html(this.hints[b]).fadeIn(1E3);
hint.position("page");$("#createNewPageButton").bind("click.msg",function(){e()});$("#canvas").bind("dblclick.msg",function(){e()});var e=function(){hint.cleanup();setTimeout(function(){hint.show("editPage")},200)};hint.bindScreenClick()}else if("editPage"==b)c.html(this.hints[b]).fadeIn(600),hint.position("page"),hint.bindScreenClick();else if("library"==b){if(!a)return;c.detach().html(this.hints[b]).prependTo($(a)).fadeIn(600);hint.position("library");$("#zoomOut").bind("click.msg",function(){hint.cleanup()});
$("#viewport").bind("mousewheel.msg",function(){hint.cleanup()})}else if("link"==b){hint.hide();if(0>=hint.linkShowCount){hint.cleanup();return}if(0<project.get("links").linkCanvId.length){hint.show("end");return}hint.position("default");c.detach().hide().prependTo("#contextMenuItems").html(this.hints[b]).css({top:-41,left:-33}).fadeIn(50);hint.linkShowCount--}else"draggingLink"==b?hint.linkShowCount=0:"end"==b&&(hint.cleanup(),c.hide());project.set({hint:b})}},bindScreenClick:function(){$(".screen").live("click.msg",
function(){if(!$(this).hasClass("active")){hint.cleanup();var b=$(this);setTimeout(function(){hint.show("library",b)},400)}})},hide:function(){$("#canvas").unbind(".msg");$("#hint").remove()},position:function(b){if("center"==b){var b=800,a=$("#canvas").offset(),c=utils.getTLWH("#viewport"),d=$("#hint").outerHeight(),d=c.height/2-a.top-d/2-50,e=c.width/2-a.left-b/2;$("#hint").css({top:d,left:e,width:b,"text-align":"center"})}else"page"==b?(e=utils.getTLWH($(".screen:last")),b=500,a=$("#canvas").offset(),
c=utils.getTLWH("#viewport"),d=0-a.top+e.top-110,e=0-a.left+e.left-220,d<50-a.top&&(d+=240),e<0-a.left&&(e+=160),e>c.width-a.left-b&&(e-=b),$("#hint").css({top:d,left:e,width:b,"text-align":"center"})):"library"==b?(b=300,$("#hint").css({top:0,left:0,width:b,"text-align":"left",padding:10,"z-index":2})):"default"==b&&$("#hint").css({top:"",left:"",width:"","text-align":"",padding:""})},hide:function(){$("#hint").hide()},cleanup:function(){$("#hint").fadeOut(200);$(document).unbind(".msg");$("#canvas").unbind(".msg");
$("#createNewPageButton").unbind(".msg");$(".libraryWidget").unbind(".msg");$("#zoomOut").unbind(".msg");$("body").unbind(".msg");$("#contextMenuItems .main").unbind(".msg");$("#viewport").unbind(".msg")}},notification={config:{displayDuration:4500,alertDisplayDuration:9E3,alertTypes:["alert","testAlert"],alertResumeThreshold:1E3,messageExpiration:2E3,pageSize:3,expandMessageDelay:30,fadeInDuration:300,fadeOutDuration:150,openDuration:300,closeDuration:150,moveDuration:300,summaryOrientation:"horizontal",
summaryShowDuration:1E3,summaryFadeInDuration:150},messages:[],alerts:[],summaries:{total:{count:0}},expandedType:null,expandedPage:0,currentMessage:null,currentPage:0,messageTimeout:null,summaryTimeout:null,interrupted:!1,init:function(){$("#tmplNotifications").tmpl({}).appendTo("body");$("#notifications > .summaries").mouseover(function(){notification._stopSummaries()}).mouseout(function(){notification.expandedType||notification._hideSummariesDelayed()})},add:function(b,a,c,d){$.isPlainObject(c)?
(d=c,c=void 0):d|=NaN;a={type:b,message:a,scope:d.scope,permanent:Boolean(d.permanent)};-1<$.inArray(b,this.config.alertTypes)?(this.alerts.push(a),this._drawAlerts()):(this._stopSummaries(),this.messages.push($.extend(a,{info:c||d.info})),this.summaries.hasOwnProperty(b)?this.summaries[b].count++:this.summaries[b]={count:1},this._updateTotal(),this._drawMessages(),this._drawSummaries())},remove:function(b){if(!b.removed){this.currentMessage&&this.currentMessage===b&&this._stopMessages();this._stopMessageExpiration(b);
var a=-1<$.inArray(b.type,notification.config.alertTypes);a?this.alerts.splice($.inArray(b,this.alerts),1):(this.messages.splice($.inArray(b,this.messages),1),this.summaries[b.type].count--);this._updateTotal();b.removed=!0;b.element.is(":visible")?(b.element.fadeOut(this.config.fadeOutDuration,function(){b.element.remove();a?notification.alerts.length==0&&notification._continueInterrupted():notification.expandedType||notification._drawNextCollapsed()}),0<this.alerts.length&&notification._drawAlerts()):
b.element.remove();if(!a){if(this.expandedType&&0==this.alerts.length){var c=this._pageOfType(this.expandedType,this.currentPage);$(c).map(function(){return this.element}).not(":visible").fadeIn(this.config.fadeInDuration);this._drawMessages()}this._drawSummaries();this.expandedType&&0==this.summaries[this.expandedType].count&&(this.expandedType=null,this._hideSummariesDelayed())}}},removeAll:function(b,a){a&&!$.isArray(a)&&(a=[a]);var c;c=b?[-1<$.inArray(b,this.config.alertTypes)?this.alerts:this.messages]:
[this.messages,this.alerts];for(var d=0;d<c.length;d++)for(var e=c[d],f=e.length-1;0<=f;f--){var g=e[f];(!a||-1<$.inArray(g.scope,a))&&this.remove(g)}},expand:function(b){if(0==this.alerts.length)if(this._stopMessages(),this._stopSummaries(),this.expandedType)this.collapse(function(){notification.expand(b)});else if(this.expandedType=b,this.currentPage=0,this.currentMessage){var a=function(){notification.currentMessage=null;window.setTimeout(function(){notification._showMessages(b)},10)};this.currentMessage.element.data("stopped")?
this.currentMessage.element.queue(a):this.currentMessage.element.fadeOut(this.config.fadeOutDuration,a)}else this._showMessages(b)},_showMessages:function(b,a,c,d){if(!a){this._drawPager();var e=this._pageCount(),d=1<e?-1*$("#notifications .pager").outerHeight(!0):0;this.currentPage>=e&&(this.currentPage=e-1);a=this._pageOfType(b,this.currentPage);c=0}e=a[c];this._drawMessage(e,d);d-=e.element.outerHeight();this.messageTimeout=new Timeout(this.config.expandMessageDelay,function(){c<a.length-1&&notification._showMessages(b,
a,c+1,d)})},_nextOfType:function(b,a){var c,d=a?$.inArray(a,this.messages):-1;if(!b||"total"==b)d<this.messages.length-1&&(c=this.messages[d+1]);else for(var d=d+1,e=this.messages.length;d<e;d++){var f=this.messages[d];if(f.type==b){c=f;break}}return c},_pageOfType:function(b,a){var c=[],d=a*this.config.pageSize,e=d+this.config.pageSize-1;if(!b||"total"==b)c=this.messages.length-e-1,c=this.messages.slice(Math.max(c,0),c+this.config.pageSize);else for(var f=0,g=this.messages.length-1;0<=g;g--){var h=
this.messages[g];if(h.type==b){f>=d&&c.unshift(h);if(f==e)break;f++}}return c},collapse:function(b){this._stopMessages();this.expandedType=null;this._hideMessages(b);this._hideSummariesDelayed()},_hideMessages:function(b,a,c){void 0===c&&"boolean"==typeof a&&(c=a,a=void 0);a||(a=this._prevVisible());var d=$(a.element),e=notification._prevVisible(a);!e&&!c&&(d=d.add("#notifications .pager"));$.when(d.fadeOut(this.config.fadeOutDuration)).then(function(){a.expanded&&notification._toggleInfo(a);!e&&
b&&a.element.queue(function(){a.element.dequeue();b.call(notification)})});e&&(this.messageTimeout=new Timeout(this.config.expandMessageDelay,function(){notification._hideMessages(b,e,c)}))},_prevVisible:function(b){for(var a,b=(b?$.inArray(b,this.messages):this.messages.length)-1;0<=b;b--){var c=this.messages[b];if(c.element&&c.element.is(":visible")){a=c;break}}return a},_drawMessages:function(){0==this.alerts.length&&(this.expandedType?this._drawExpanded():this._drawCollapsed())},_drawExpanded:function(b,
a){var c;c=a?{idx:0,next:function(){return this.idx<notification.alerts.length?notification.alerts[this.idx++]:null}}:{page:this._pageOfType(this.expandedType,this.currentPage),idx:0,next:function(){return this.idx<this.page.length?this.page[this.idx++]:null}};var d=0,e=b||0;this._drawPager();1<this._pageCount()&&(e-=$("#notifications .pager").outerHeight(!0));for(var f,g;d<this.config.pageSize&&(f=c.next());){g||(g=f);if(!f.removed)if(f.shown){var e=e-f.element.outerHeight(),h=f.element.is(":visible");
e!=f.element.position().top?h?f.element.animate({top:e},this.config.moveDuration):f.element.css({top:e}).fadeIn(this.config.fadeInDuration):h||f.element.fadeIn(this.config.fadeInDuration)}else this._drawMessage(f,e),a&&!f.permanent&&(f.timeout=new Timeout(this.config.alertDisplayDuration,function(a){return function(){notification.remove(a)}}(f))),e-=f.element.outerHeight();d++}if(!a)for(f=g;f=this._prevVisible(f);)f.element.fadeOut(this.config.fadeOutDuration)},_drawCollapsed:function(){if(!this.currentMessage&&
(!this.messageTimeout||this.messageTimeout.complete())){for(var b=0,a=this.messages.length;b<a;b++){var c=this.messages[b];if(!c.removed&&!c.shown){this.currentMessage=c;break}}this.currentMessage?(this._drawMessage(this.currentMessage,0),this.messageTimeout=new Timeout(this.config.displayDuration,function(){notification._drawNextCollapsed()})):this._hideSummariesDelayed()}},_drawNextCollapsed:function(){this.currentMessage&&this.currentMessage.element&&!this.interrupted&&(this.currentMessage.element.is(":visible")?
this.currentMessage.element.fadeOut(this.config.fadeOutDuration,function(){var b=notification.currentMessage;notification.currentMessage=null;(!b||!b.element||!b.element.data("stopped"))&&notification._drawCollapsed()}):(notification.currentMessage=null,notification._drawCollapsed()))},_drawAlerts:function(){var b=0,a=this._expandedMessage();a&&(b=-1*a.element.outerHeight(),a.element.position().top!=b&&a.element.animate({top:b+"px"},this.config.moveDuration));this._interrupt(function(){notification._drawExpanded(b,
true)})},_drawMessage:function(b,a){var c=$("#notifications .messages ul");b.element?b.element.show():(b.element=$("#tmplNotification").tmpl({type:b.type,text:"string"==typeof b.message?b.message:$(b.message).html(),info:"string"==typeof b.info?b.info:$(b.info).html()}).addClass("collapsed").click(function(a){return-1==$.inArray(a.type,notification.config.alertTypes)?function(){notification._toggleInfo(a)}:function(){}}(b)).prependTo(c),b.element.find(".close").click(function(a){return function(b){notification.remove(a);
b.stopPropagation()}}(b)),b.element.find("input[type=submit], input[type=button], button").click(function(a){return function(){notification.remove(a)}}(b)));b.element.stop(!0,!0).dequeue().css({width:b.element.closest("div").width()-b.element.outerWidth()+b.element.width()}).css({top:a-b.element.outerHeight()}).hide().fadeIn(this.config.fadeInDuration);b.shown=!0},_pageCount:function(){return this.expandedType?Math.ceil(this.summaries[this.expandedType].count/this.config.pageSize):1},_drawPager:function(){var b=
$("#notifications .pager"),a=b.find(".pager-page"),c=this._pageCount();if(a.size()!=c){b.empty();for(a=0;a<c;a++){var d=$("#tmplNotificationPage").tmpl({}).click(function(a){return function(){notification._toPage(a)}}(a)).appendTo(b);a==this.currentPage&&d.addClass("active")}}else a.filter(".active").removeClass("active"),a.eq(this.currentPage).addClass("active");1<c?b.fadeIn(this.config.fadeInDuration):b.fadeOut(this.config.fadeOutDuration)},_toPage:function(b){this._hideMessages(function(){this.currentPage=
b;this._showMessages(this.expandedType)},!0)},_updateTotal:function(){this.summaries.total.count=0;for(var b in this.summaries)"total"!=b&&(this.summaries.total.count+=this.summaries[b].count)},_drawSummaries:function(){var b=$("#notifications .summaries ul"),a=0,c="vertical"!=this.config.summaryOrientation,d;for(d in this.summaries){var e=this.summaries[d];if(e.element)if(0<e.count){e.element.children(".summary").text(e.count.toString());var f=e.element.is(":visible"),g=e.element.position();a!=(c?
g.left:g.top)?(g=c?{left:a}:{top:a},f||(e.element.css({opacity:0.001}).show(),g.opacity=1),e.element.animate(g,this.config.moveDuration)):f||e.element.fadeIn(this.config.fadeInDuration);"total"==d&&e.element.hasClass("totalHidden")&&e.element.switchClass("totalHidden","",this.config.fadeInDuration)}else e.element.fadeOut(this.config.fadeOutDuration);else 0<e.count&&(e.element=$("#tmplNotificationSummary").tmpl({type:d,text:e.count.toString()}).css(c?{left:a}:{top:a}).click(function(a,b){return function(){"total"==
b&&a.element.hasClass("totalHidden")?notification._showSummaries():notification.expandedType==b?notification.collapse():notification.expand(b)}}(e,d)).hide().appendTo(b).fadeIn(this.config.fadeInDuration));0<e.count&&e.element&&(a+=c?e.element.outerWidth():e.element.outerHeight())}},_toggleInfo:function(b){this._stopMessages();var a=b.element.find(".message .content"),c;this.expandedType&&!this.interrupted&&(c=this._pageOfType(this.expandedType,this.currentPage),c=$(c).map(function(){return this.element[0]}).not(b.element));
b.expanded?(b.element.is(":visible")?(c&&c.fadeIn(this.config.fadeInDuration),c=b.element.outerHeight()-a.height(),a.animate({height:b.height},{duration:this.config.closeDuration,complete:function(){notification._hideInfo(b);notification.expandedType||notification._drawNextCollapsed()}}),b.element.animate({top:0<this.alerts.length?-1*(b.height+c):b.top},this.config.closeDuration)):notification._hideInfo(b),b.expanded=!1,notification._startMessageExpiration(b)):(c&&c.fadeOut(this.config.fadeOutDuration),
b.top=b.element.position().top,b.height=a.height(),b.element.removeClass("collapsed").addClass("expanded"),a.find(".info").show(),c=-1*b.element.outerHeight(),0<this._pageCount()&&(c-=$("#notifications .pager").outerHeight(!0)),c<b.top&&b.element.animate({top:c},this.config.openDuration),c=a.height(),a.css({height:b.height+"px"}).animate({height:c},this.config.openDuration),b.expanded=!0);0<this.alerts.length&&(b.element.fadeOut(this.config.fadeOutDuration),this._drawAlerts())},_interrupt:function(b){var a=
this.interrupted;if(!a){this.interrupted=!0;if(this.messageTimeout&&!this.messageTimeout.complete()&&!this.messageTimeout.paused()){this.messageTimeout.pause();for(var c=0,d=this.messages.length;c<d;c++){var e=this.messages[c];e.expirationTimeout&&e.expirationTimeout.pause()}}this.expandedType?(a=Boolean(this._expandedMessage()))||this._hideMessages(function(){b.call()}):this.currentMessage&&!this.currentMessage.expanded&&!this.currentMessage.removed?this.currentMessage.element.fadeOut(this.config.fadeOutDuration,
function(){b.call()}):a=!0}a&&b.call()},_continueInterrupted:function(){var b=!0;this.interrupted=!1;this.messageTimeout&&!this.messageTimeout.complete()&&this.messageTimeout.paused()&&(this.messageTimeout.timeRemaining()>=this.config.alertResumeThreshold?this.messageTimeout.resume():(this.messageTimeout.exec(),b=!1));for(var a=0,c=this.messages.length;a<c;a++){var d=this.messages[a];d.expirationTimeout&&d.expirationTimeout.paused()&&d.expirationTimeout.resume()}this.expandedType?this._expandedMessage()||
this._showMessages(this.expandedType):this.currentMessage&&b&&(this.currentMessage.removed?this._drawNextCollapsed():this.currentMessage.element.fadeIn(this.config.fadeInDuration))},_startMessageExpiration:function(b){this._stopMessageExpiration(b);b.expirationTimeout=new Timeout(this.config.messageExpiration,function(){b.element.addClass("expired")})},_stopMessageExpiration:function(b){b.expirationTimeout&&(b.expirationTimeout.stop(),b.expirationTimeout=null)},_hideInfo:function(b){var a=b.element.find(".message .content");
a.find(".info").hide();a.css({height:""});b.element.removeClass("expanded").addClass("collapsed")},_expandedMessage:function(){for(var b,a=0,c=this.messages.length;a<c;a++){var d=this.messages[a];if(d.expanded&&!d.removed){b=d;break}}return b},_stopMessages:function(){this.messageTimeout&&!this.messageTimeout.complete()?this.messageTimeout.stop():this.currentMessage&&this.currentMessage.element&&this.currentMessage.element.is(":animated")&&this.currentMessage.element.data("stopped",!0)},_showSummaries:function(){this._stopSummaries();
for(var b in this.summaries){var a=this.summaries[b];a.element&&("total"==b?a.element.switchClass("totalHidden","",this.config.summaryFadeInDuration):0<a.count&&a.element.fadeIn(this.config.summaryFadeInDuration))}},_hideSummaries:function(){this._stopSummaries();var b=$("#notifications > .summaries");b.find("li.total").switchClass("visible","totalHidden",this.config.fadeOutDuration);b.find("li").filter(":not(.total)").fadeOut(this.config.fadeOutDuration)},_hideSummariesDelayed:function(){this._stopSummaries();
this.summaryTimeout=new Timeout(this.config.summaryShowDuration,function(){notification._hideSummaries();notification.summaryTimeout=null})},_stopSummaries:function(){this.summaryTimeout&&(this.summaryTimeout.stop(),this.summaryTimeout=null)}},search={filter:function(){var b=$("#searchBox").val(),a=0;$("#library .libraryWidget").each(function(){var c=widget.get($(this).attr("id")),d=!1,e=c.x?c.x.slice():[];c.title&&e.push(c.title);(c=$(this).closest("ol").attr("id"))&&e.push(c);for(var f in e)if(-1<
e[f].search(RegExp(b,"i"))){a++;d=!0;break}d?$(this).removeClass("hidden"):$(this).addClass("hidden")});$("#library .overview .setHeader").not(".libraryUploads").each(function(){0<$(this).find(".libraryWidget").not(".hidden").length?$(this).show():$(this).hide()});"Uploads"==$("#widgetGroupTitle").text()&&(a++,$("#widgetGroupUploads").parent().show());0==a?$(".emptyLibDisplay").show():$(".emptyLibDisplay").hide();setTimeout(lib.updateScrollbar,10)},showAll:function(){$("#searchBox").val("");searchFilter.filter()},
focus:function(){$("#searchBox").focus().select()}},fluidDropdownScrollbar=null,color="orange,red,lightBlue,green,darkBlue,yellow".split(","),fluidMenu={openDuration:300,closeDuration:300,init:function(){this.updateScrollbar()},updateScrollbar:function(b){var a=$("#fluidDropdown .scrollHolder");a.data("tsb")||a.tinyscrollbar();a.tinyscrollbar_update(b||"relative")},click:function(b){var a=$(b.target);if("tsandcsLabel"==b.target.id||"tsandcs1"==b.target.id||a.hasClass("createAccount"))return!0;if("INPUT"==
b.target.tagName&&a.hasClass("title"))return a.focus(),a.select(),!1;if("upgradeLink"==b.target.id||"A"==b.target.tagName&&!a.hasClass("submenuLink"))return!0;"logout"==b.target.id&&account.logout();a=a.closest(".project, .addProject");0<a.length&&(a.hasClass("addProject")?(project.add(),tracker.record("addProject",1,"",b)):(project.open(a.attr("id")),tracker.record("openProject",10,a.attr("id"),b)));return!1},toggle:function(){$("#fluidDropdown").is(":visible")?(contextMenu.place(),fluidMenu.hide()):
(contextMenu.place("hide"),tracker.record("FluidMenuClicked",5,""),fluidMenu.show(this));widget._stopEditingText();return!1},feedbackAjaxResponse:function(){$("#feedbackForm").empty();$("#tmplFeedback2").tmpl({}).appendTo("#feedbackForm")},setupFeedback:function(b){$("#feedbackForm").empty();var a=account.get("email");if(null==a||"New"==a)a="";var c=account.get("name");null==c&&(c="");$("#tmplFeedback").tmpl({name:c,email:a}).appendTo("#feedbackForm");$("#feedbackForm input").not("[type=hidden]").each(function(){validateInput(b,
this)})},allowNewProjects:function(b){b||void 0===b?($("#projectSignupWarning").hide(),$("#projectList, #inactiveProjectList").show()):($("#projectSignupWarning").show(),$("#projectList, #inactiveProjectList").hide())},hide:function(){if($("#startMenu").hasClass("open")){$("#hud").data("openMenu",!1);$("#startMenu").removeClass("open");var b=$("#fluidDropdown");utils.animateRaf(function(a){b.css({"-webkit-transform":"scale("+(1-a)+")","-moz-transform":"scale("+(1-a)+")"})},fluidMenu.closeDuration,
"easeInOutQuad",function(){b.removeAttr("style").hide()});"no"==account.get("loggedIn")&&$("#saveNowButton").fadeIn(400);$("#trash").removeClass("shown");fluidMenu.resetSelectedMenu()}},show:function(b){$("#fluidDropdown .overview article").hide();0<$("#fluidDropdown .fluidSubmenuActive").length&&(b=$("#fluidDropdown .fluidSubmenuActive").attr("data-for"));$("#"+b).show();$("#startMenu").addClass("open");var a=$("#fluidDropdown").css({"-webkit-transform":"scale(0.05)","-moz-transform":"scale(0.05)"}).show();
utils.animateRaf(function(b){a.css({"-webkit-transform":"scale("+b+")","-moz-transform":"scale("+b+")"})},fluidMenu.openDuration,"easeOutBack",function(){a.removeAttr("style").show()});$("#trash").addClass("shown");fluidMenu.updateScrollbar();tracker.record("openFluidMenu",5,b)},openDropdown:function(b){var a=$(this),c=a.attr("data-for"),d=$("#"+c);"profile"!=c&&("feedback"==c?fluidMenu.setupFeedback():"projects"==c&&project.setNumber());$("#fluidDropdownSubmenu a").removeClass("fluidSubmenuActive").filter("[data-for="+
c+"]").addClass("fluidSubmenuActive");$("#fluidDropdown article").not("#"+a.attr("data-for")).hide();d.fadeIn(200);fluidMenu.updateScrollbar();tracker.record("changeFluidMenu"+c,5,c,b)},viewportDrop:function(b,a){b.stopPropagation();b.originalEvent&&b.originalEvent.stopPropagation();$("#projectList").hasClass("hover")?project.dropToActive(a.draggable):$("#inactiveProjectList").hasClass("hover")&&project.dropToInactive(a.draggable)},resetSelectedMenu:function(b){var a=$(".fluidSubmenuActive").attr("data-for");
(b=b||!1)||("no"==account.get("loggedIn")&&"profile"!=a?b=!0:"help"==a&&(b=!0));b&&($(".submenuLink").removeClass("fluidSubmenuActive"),$(".submenuLink[data-for='profile']").addClass("fluidSubmenuActive"))},setButtonStyle:function(b,a){var c=a?0:1,d=0==c?"data-style-ori":"data-style-alt",e=0==c?"data-text-ori":"data-text-alt";$.each(b,function(a,b){var c=$(".icon",$(b)),i=c.attr(d),j=c.attr(e);i&&""!=i&&$(".iconAvatarContainer",c).attr("class","iconAvatarContainer "+i);i=$(".buttonText",c);j&&""!=
j?(c.removeClass("iconCollapsed"),$(b).removeClass("buttonCollapsed"),c.addClass("iconExpanded"),$(b).addClass("buttonExpanded"),i.text(j),i.addClass("textVisible")):(c.addClass("iconCollapsed"),$(b).addClass("buttonCollapsed"),i.text(""),i.removeClass("textVisible"))})}},adminConsole={resetAll:function(){!0==confirm("ARE YOU SURE YOU WANT TO RESET?\nAll your projects and information will be lost!")?(localStorage.clear(),window.location.reload()):$("#console").fadeOut(200)},resetCanvas:function(){project.set({canvasPosY:10,
canvasPosX:10});$("#canvas").css({top:10,left:10});$("#console").fadeOut(200)},logPerformanceData:function(){console.log("document Events");console.log("Storage:",storage.tempStorage);console.log("Total dom elements:  ",$("*").size());var b={},a=0;$("*").each(function(){var c=$(this).data("events");if("undefined"!=typeof c)for(var d in c)"undefined"!=typeof b[d]?b[d]++:b[d]=1,a++});console.log("EventCount: ",b);console.log("Total events: ",a)}},signup={hide:function(){$("#signup").hide()},show:function(){signup.toggleTabMessage();
$("#signup").delay(500).fadeIn(500)},toggleTab:function(){widget.resetSelection();contextMenu.hide();link.closeMenu();if($("#signup").hasClass("open")){var b=-460,a="Save",c="";$("#library").hasClass("signingUpHidden")&&$("#library").removeClass("signingUpHidden").show();$("#previewHolder").hasClass("open")?$("#previewHolder").fadeIn(400,function(){$("#hud, #canvas, #trash").show()}):$("#hud, #canvas, #trash").fadeIn()}else b=0,a="Not Yet",c="Create account or sign in or to save",1==project.get("currentZoom")&&
$("#library").addClass("signingUpHidden").hide(),$("#projectName").hide(),$("#previewHolder").hasClass("open")?($("#hud, #canvas, #trash").hide(),$("#previewHolder").fadeOut()):$("#hud, #canvas, #trash").fadeOut();$("#editorSignupForm").empty();c={place:"save",cta:"Save Project",uid:account.get("currentUserId"),comment:c};$("#tmplSignup").tmpl(c).appendTo("#editorSignupForm");$("#signup").animate({top:b},200,"swing").toggleClass("open");$("#signupTab").html(a).toggleClass("openTab");signup.toggleTabMessage();
return!1},toggleTabMessage:function(){var b="Later";$("#signup").hasClass("open")||(b=$("#previewHolder").hasClass("open")?"View on Mobile":"Save");$("#signupTab").html(b)},submit:function(){var b=$(this).find("input").not("[type=hidden], [type=submit]").length,a=$(this).find(".formCorrect").length,c=$(".createAccount");if(a<b||c.hasClass("inactive"))return!1;b=$(this).serialize();signup.ajaxProcessing();$.ajax({url:"./index.php",type:"POST",data:b,timeout:15E3,success:signup.ajaxSuccess,error:signup.ajaxError,
timeOut:signup.ajaxProcessingTimeout});return!1},ajaxProcessing:function(){var b=$(".createAccount"),a="Signing in...";-1<b.val().indexOf("Create")&&(a="Creating new account...");b.val(a).addClass("inactive")},ajaxSuccess:function(b,a,c){try{var d=JSON.parse(c.responseText)}catch(e){return notification.add("error","A server error has occurred - please try again."),$(".createAccount").removeClass("inactive").val("Ready"),!1}if("s"!=d.r)return"passwordFail"==d.r?notification.add("alert","Email and password do not match - please try again."):
notification.add("alert","An unknown error has occurred - please try again."),$(".createAccount").removeClass("inactive").val("Ready"),!1;$(".createAccount").removeClass("inactive").val("Loading elements...");b="FluidMenu";0<$("#previewSignupForm:visible").size()&&(b="Preview");switch(d.a){case "create":signup.handleSuccess(d);tracker.record("signUpVia"+b,1,d.Email,"");notification.add("alert","Your account was created successfully. Your work will be automatically saved from now on.");break;case "login":tracker.record("login",
1,d.Email,""),account.login(d)}$("#editorSignupForm").html($("#tmplSignupComplete").tmpl());return!1},ajaxProcessingTimeout:function(){},ajaxError:function(){},handleSuccess:function(b){account.register(b);b=account.get("lastOpenProject");project.sync(b);fluidMenu.setButtonStyle($("#startMenu"),!0);$("#previewSignup").hide();$("#previewShare").show()},closeAfterCompleting:function(){signup.toggleTab();$("#signup").fadeOut();$("#startMenu").fadeIn()}};
function userActionsInit2(){$("#pageFrame").click(function(b){widget.resetSelection();contextMenu.hide();widget._stopEditingText();"pageFrame"==b.target.id&&page.hideOptionsMenu();return!1});$("#pageMenus").click(function(){return!1});$("#pageMenuToggle").click(page.toggleOptionsMenu);$("#pageAddNote").click(page.toggleNotes);$("#pageDuplicate").click(page.duplicate);$("#DeviceSizeTmpl").bind("change",project.setDevice);$(".makeHomepage").click(page.makeHome);$(".orientationSelector2").change(project.orient);
$(".orientationSelector").change(page.orient);$(".screenSize").bind("change click keyup",project.changeScreenSize);$(".pageSize").bind("change click keyup",page.manualResize);$("#uploadButton").click(lib.toggleUploads);$("#saveNowButton").click(saveNowButtonClick)}
function userActionsInit(){$(".form input").live("change",validateInput);$(".createForm [type=email]").live("change",function(b){account.checkEmailExists($(b.target).val())});$(".createForm [type=email]").click(autoFillEvent.startCheck);$(".recoverPassword").live("click",function(){account.recoverPassword();return!1});$("#trash, #trashIcon").droppable({accept:".project, .screen, .pageWidget",greedy:!0,tolerance:"touch",drop:deleteObject}).click(function(){return deleteObject("delete")});$("#zoomOut").click(canvas2.zoomOut);
$("#closeDropzone").click(upload.hide);$("#signupTab").click(signup.toggleTab);$(".createForm").live("submit",signup.submit);$("#previewMail").submit(ajax.submit);$("#continueProject").live("click",signup.closeAfterCompleting);$("#fluidMenu").click(fluidMenu.toggle);$("#resetEmail").live("click",fluidMenu.setupFeedback);$("#fluidDropdownSubmenu > a, #projects a").click(fluidMenu.openDropdown);$("#fluidDropdown").click(fluidMenu.click);$(".project").liveDraggable({appendTo:"body",cancel:".addProject",
containment:"body",cursorAt:{right:25,bottom:25},helper:"clone",tolerance:"pointer",opacity:"0.4",zIndex:11,revert:"invalid",distance:15,revertDuration:200,start:project.dragStart,drag:project.drag,stop:project.dragStop}).live({mouseenter:project.hoverIn,mouseleave:project.hoverOut}).find(".title").live("blur",project.rename);$("#fluidDropdown .viewport").droppable({accept:".project",tolerance:"pointer",greedy:!0,drop:fluidMenu.viewportDrop});$("#upgradeLink").live({click:account.startUpgrade});propInspector.init();
$("#contextMenuItems").draggable({handle:".drag-handler",distance:5,containment:"#viewport",start:contextMenu.dragStart,stop:contextMenu.dragStop});$("#cmLink2").draggable({helper:cmLink2Helper,distance:5,cursorAt:{left:0,top:0},cursor:"url(img/cursorGrabbing.gif), crosshair",containment:"#viewport",start:link.dragStart,drag:link.drag,stop:link.dragStop,appendTo:"body"});$(".subExpander").parent().hover(function(){$(this).find(".subExpander").stop().fadeTo(50,1)},function(){$(this).find(".subExpander").show().stop().fadeTo(800,
0)});$("#propertyInspector").click(function(){propInspector.hideColorPickers();widget._stopEditingText();return!1});$("#textColor, #shapeBackground, #shapeBorder").simpleColorPicker({onChangeColor:propInspector.colorPicked});$("#textSize").change(propInspector.selectChanged);$("#textFont").change(propInspector.selectChanged);$("#shapeBorderWidth").add("#shapeBorderRadius").add("#shapeHeight").add("#shapeWidth").change(propInspector.selectChanged).click(propInspector.selectChanged).keyup(propInspector.selectChanged);
$("#shapeOpacity").change(propInspector.sliderChanged);$("#textOpacity").change(propInspector.sliderChanged);$(".inspectorInner .checkbox").click(propInspector.toggleCheckboxStyle);$(".inspectorInner .radio").click(propInspector.toggleRadioStyle);$(".inspectorInner .hozontalAlignment").click(propInspector.togglehozontalAlignment);$("#textTop").change(propInspector.sliderChanged);$("#contextMenu2").click(function(b){var a=b.originalEvent;switch(b.target.id){case "cmAlignLeft":case "cmAlignRight":case "cmAlignTop":case "cmAlignBottom":case "cmAlignMiddle":case "cmAlignCenter":contextMenu.cmAlign(a);
break;case "cmFront":case "cmBack":case "cmFrontOne":case "cmBackOne":contextMenu.cmZAlign2(a);break;case "cmCut":widget.cut(a);break;case "cmCopy":widget.copy(a);break;case "cmPaste":widget.paste(a);break;case "cmDelete":deleteObject("delete");break;case "cmDuplicate":widget.duplicate(a);break;case "cmAddSegment":widget._addSegment(a);break;case "cmDeleteSegment":widget._deleteSegment(a);break;case "cmLink":contextMenu.linkClickDragStart(a);break;case "cmReplaceToggle":contextMenu.toggleReplace(a);
break;case "menuExpander":case "textMenuExpander":propInspector.toggle(a)}propInspector.hideColorPickers();widget._stopEditingText();return!1});$("#contextMenuItems .main").click(contextMenu.toggle);$(".subExpander").click(contextMenu.toggleSubmenu);$(".subExpander").siblings().click(contextMenu.markAsLastClicked);$(".screen").live("click",page.click).liveDraggable({stack:".screen",cancel:":input, option",start:page.dragStart,drag:page.drag,stop:page.dragStop,distance:4}).liveSelectable({distance:10,
filter:".rootWidget:not(.backgroundWidget)",tolerance:"touch",start:page.selectStart,stop:page.selectStop,cancel:":input, option, .icon, .pageDragHandle"});$("#canvasPages .pageWidget").live("click",widget.click).live("mouseover mouseleave",widget.hover).liveDraggable({distance:4,appendTo:"body",snap:"#canvasPages .widgetHolder, #canvasPages .pageWidget",cancel:":input,option,.backgroundWidget",snapTolerance:4,create:widget.dragWidgetCreate,start:widget.dragWidgetStart,drag:widget.dragWidget,stop:widget.dragWidgetStop}).draggable("disable");
$("#canvasPages .pageWidget .widgetText").live("dblclick",widget.editText);$("#canvasLinks .link").live({mouseenter:link.hoverIn,mouseleave:link.hoverOut,click:link.follow});$(".linkToggle").live("click",link.toggleMenu);$(".linkMenu").draggable({handle:".linkMenu h4"}).click(!1);$(".removeLink").click(link.del);$(".transitionSelector").live("change",link.changeTransition);$(".linkTriggerSelector").live("change",link.changeTrigger);$("#createNewPageButton").click(page.createNew);$("#preview").click(function(b){preview.open(b);
tracker.record("clickPreview",1,"",b)});$("#closePreview").click(preview.close);$("#previewScale").change(function(){$("#previewPage").css({"-webkit-transform":"scale("+$(this).val()+")","-moz-transform":"scale("+$(this).val()+")"})});$("#printLink").live("click",preview.printLink);$("#DownloadLink").live("click",preview.downloadLink);$("#exportImgLink").live("click",preview.exportImgLink);$("#exportFullImgLink").live("click",preview.exportFullImgLink);$("#previewLink").click(launchPreviewWindow);
$("#previewLink2, #embedCode").click(preview.copyLinkOrCode);$("#previewFacebook, #previewTwitter").click(preview.logSharedProject);$("#forceDevicePreview").live("click",function(){alert("click");preview.load(g_preview);return!1});$(document).keyup(keyU).keydown(keyD);$("#viewport").bind("mousewheel",canvas2.mousewheel);$("#library").resizable({handles:"e",minWidth:0,maxWidth:700,stop:lib.resize});$(".libraryWidget").live("dblclick",widget.doubleClick).liveDraggable({distance:3,cursorAt:{left:12,
top:12},appendTo:"body",snap:"#canvasPages .widgetHolder, #canvasPages  .pageWidget",snapTolerance:5,helper:lib._createDragHelper,drag:widget.libraryDrag,cursor:"pointer"});$("#searchBox").mouseover(function(){this.placeholder=""}).mouseleave(function(){this.placeholder="Search Library"}).focus(function(){$(this).css("border-color","#FFF")}).blur(function(){$(this).css("border-color","")}).click(search.filter).keyup(search.filter).click(search.focus);$("#tabLibrary").click(lib.toggle);$("#tabPreveiw").click(preview.toggle);
$("#widgets h6").live("click",lib.collapseSection);$("#Preveiw h6").live("click",lib.collapseSection);$(".librarySet").live("click",lib.changeSet);$("#widgetGroupSelect a").live("click",lib.dropdownChangeSet);$("#library header").live({mouseenter:lib.setHeaderHoverIn,mouseleave:lib.setHeaderHoverOut});$("#Preveiw header").live({mouseenter:lib.setHeaderHoverIn,mouseleave:lib.setHeaderHoverOut});$("#uploadClick").live("change",upload.uploadByClick);$("#linkLoggedOut").live("click",fluidMenu.show);$("#console").click(function(b){var a=
b.originalEvent;switch(b.target.id){case "resetAll":adminConsole.resetAll(a);break;case "resetCanvas":adminConsole.resetCanvas(a);break;case "consoleClose":$("#console").fadeOut(200);break;case "logData":adminConsole.logPerformanceData(a);break;case "profileStart":console.profile();break;case "profileEnd":console.profileEnd()}return!1});$("#viewport, #addPage").droppable({drop:dropInViewport,tolerance:"pointer"});$("#canvas").draggable({distance:5,start:canvas2.dragStart,drag:canvas2.drag,stop:canvas2.dragStop,
containment:canvas2.setContainment(),cancel:":input,option,.page"}).dblclick(page.add);$(window).unload(function(){localStorage.setItem("refreshing",g_instanceId)});$(window).resize(redraw);$(window).unload(project.windowClose);$(window).blur(project.windowClose);$(window).focus(account.recordActivity);$(window).click(tidyUp);fluidEvent.bindEditor("storageChanged",account.recordActivity);fluidEvent.bindEditor("storageChanged",project.setModified);document.body.oncopy=function(b){switch(b.target.id){case "previewLink2":preview.alertCopyLink(b);
break;case "embedCode":preview.alertCopyEmbedCode(b)}}}
var screensize={width:0,height:0},autoFillEvent={currentval:"",changeCalled:!1,inputItem:"",startCheck:function(){$(this).hasClass(".check")||(autoFillEvent.stopCheck(),$(this).addClass("check"),autoFillEvent.inputItem=$(this),autoFillEvent.Check())},Check:function(){var b=autoFillEvent.inputItem.val();!1!=$(autoFillEvent.inputItem).is(":focus")&&(autoFillEvent.currentval!=b&&(autoFillEvent.currentval=b,autoFillEvent.changeCalled=!0,autoFillEvent.inputItem.change()),0==autoFillEvent.inputItem.closest(".formCorrect").length?
setTimeout(autoFillEvent.Check,250):autoFillEvent.stopCheck())},stopCheck:function(){if(""==autoFillEvent.inputItem)return!1;autoFillEvent.inputItem.removeClass("check")}};function closeUpgradeCheck(){tracker.record("closedUpgradePanel",1);return!1}function updateTLWH(){var b=utils.getBoundingAreaRelative($(".ui-selected"));$("#widgetTL").html(b.top+", "+b.left);$("#widgetWH").html(b.right-b.left+"&times;"+(b.bottom-b.top))}
function showPostLoadMessage(){if(localStorage){var b=localStorage.getItem("postloadMessage");"tab"==b?notification.add("alert","Project updated. Please close other tabs or windows where the project may be open."):"serverRefresh"==b?notification.add("alert","A newer version of a project has been found. Updated."):"serverLogout"==b?notification.add("alert","This account appears to be open elsewhere and has been logged out to protect your changes."):"loginAgain"==b&&notification.add("alert","Something went wrong. Please log in again.");
localStorage.removeItem("postloadMessage")}}function saveNowButtonClick(){tracker.record("clickSave",5,"");fluidMenu.show($("#profile"));$(this).fadeOut(400);return!1}function launchPreviewWindow(){var b=project.get("id"),a=project.get("pageWH")||[320,480];window.open("./?p="+b+"&preview=y","Preview","left=100,top=100,width="+a[0]+",height="+a[1]+",toolbar=1,resizable=0");return!1}function cmLink2Helper(){return $(this).data("clickDragHelper")||$("#tmplDragHelper").tmpl()}
function setFocus(b){b.bounce().focus()}
function keyD(b){if(b.ctrlKey&&b.altKey&&b.shiftKey&&48==b.keyCode)return $("#console").toggle(),!1;if(17==b.keyCode||91==b.keyCode)return widget.selectMulti=!0;if((b.metaKey||b.ctrlKey)&&65==b.keyCode){if(0<$("#canvasPages .pageWidget textarea").length)return utils.selectText("control+a"),!0;if(!$("#canvas").hasClass("zoomedOut"))return widget.select(null,$(".canvasObject.active").find(".pageWidget")),!0}27==b.keyCode&&lib.esc();var a=b.target.nodeName.toLowerCase();if("input"==a||"textarea"==a)return"input"==
a&&13==b.keyCode&&$(this).blur(),!0;if(37<=b.keyCode&&40>=b.keyCode)return!1;if(46==b.keyCode||8==b.keyCode)return $("#searchBox").blur(),deleteObject(b.keyCode),!1;if(b.metaKey||b.ctrlKey){switch(b.keyCode){case 67:widget.copy(b);break;case 68:widget.duplicate(b);break;case 86:widget.paste(b);break;case 88:widget.cut(b);break;default:return!0}return!1}return!0}function keyU(b){if(37<=b.keyCode&&40>=b.keyCode)return widget.nudge(b.keyCode),contextMenu.place(),!1;widget.selectMulti=!1}
function load(){window.open("terms.html","","scrollbars=no,menubar=no,height=600,width=800,resizable=yes,toolbar=no,location=no,status=yes")}
function tidyUp(b){if("textarea"==b.target.type||"input"==b.target.type||"tsandcsLabel"==b.target.id||"tsandcs1"==b.target.id||$(b.target).hasClass("createAccount"))return!0;widget._stopEditingText();"A"!=b.target.tagName&&fluidMenu.hide();propInspector.hide();page.hideOptionsMenu();link.hoverOut();1==project.get("currentZoom")&&(widget.resetSelection(),contextMenu.place("hide"));window.g_window_print&&!window.g_window_print.closed&&"printLink"!=b.target.id&&(window.g_window_print.close(),window.g_window_print=
null)}function setValid(b){b.parents("td").next("td").find("aside").fadeTo(0,1).addClass("formCorrect").bounce()}
function validateInput(b,a){var c=$(a);if(null==a||void 0==a)a=this,c=$(this);$form=c.parents(".form").eq(0);if("previewMail"!=$form.attr("id")&&((a.validity.valid&&!1==c.is(":checkbox")||!0==("checkbox"==c.attr("type")&&c.prop("checked")))&&"submit"!=c.attr("type")?setValid(c):c.parents("td").next("td").find("aside").fadeTo(200,0).removeClass("formCorrect"),!$form.hasClass("createForm"))){var c=$form.find("input").not("[type=hidden], [type=submit]").length,d=$form.find(".formCorrect").length;setSubmitStyle($form,
c==d)}}
function intersectTrash(b){var a=utils.getTLWH(b);if($(b).hasClass("screen")){var c=project.get("currentZoom");if(1==c)return!1;b=$(".page",$(b));0<b.size()&&(a=utils.getTLWH(b));a.width*=c;a.height*=c}c=$("#libraryWidgetDragging");0<c.size()&&(c.hasClass("upload")?(a.width=24,a.height=24):a=utils.getTLWH(c.find(".pageWidget")));c=utils.getTLWH("#trash");if((a.top+a.height>=c.top||a.top>=c.top)&&(a.left>=c.left||a.left+a.width>=c.left))return $("#trash").addClass("droppableStyle"),!0;$("#trash").removeClass("droppableStyle");return!1}
function dropInViewport(b,a){if(!(b.isPropagationStopped()||b.originalEvent&&b.originalEvent.isPropagationStopped())){var c=$(a.draggable);if($(a.draggable).hasClass("project"))project.open(c.attr("id"));else if($("#trash").hasClass("droppableStyle"))account.removeUpload(a.draggable[0].id);else{if("canvas"==c.attr("id"))return!0;if(c.hasClass("libraryWidget")&&b.pageX<account.get("libraryWidth"))return!1;if("cmLink2"==c.attr("id")){utils.prevent(b);$("#dragCanvas").fadeOut(200);var d=$("#addPage").offset(),
e=$("#addPage").outerHeight();if(b.pageX>d.left&&b.pageY>d.top&&b.pageY<d.top+e)return page.addViaLinkDrop(d,e,b,a),widget.resetSelection(),!1;var f=null,g=1;c.hasClass("templateLink")?(f=c.parents(".page"),g=$("#canvas").data("revertZoom"),void 0==g&&(g=1)):f=$(".zoomedOutSelected").closest(".screen");page.enableSelectableWidgetHolder(!1)}var d=$(".screen"),h=project.get("currentZoom"),i=!1;d.each(function(){var d=$(this).find(".page"),d=utils.getTLWH(d);if(b.pageX<d.left||b.pageX>d.left+d.width*
h||b.pageY<d.top||b.pageY>d.top+d.height*h)return!0;if(c.hasClass("libraryWidget"))widget.add(b,{top:0,left:0},a.draggable[0].id,$(this).find(".widgetHolder")),tracker.record("addWidget",1,a.draggable[0].id,b);else if("cmLink2"==c.attr("id")){var e=$(this);$(".zoomedOutSelected").each(function(){canvas=link.add($(this).attr("id"),e.attr("id"),"ahref");tracker.record("addLink",1,"",b);link.draw(canvas,$(this),e,"ahref")});i=!0}else if(c.hasClass("pageWidget")){var d=$(this).attr("id"),f=c.closest(".screen").attr("id");
if(f!=d){var g=$("#canvasPages .ui-selected");widget._changePage(g,f,d)}}return!1});"cmLink2"==$(a.draggable).attr("id")&&(i?widget.resetSelection():setTimeout(function(){canvas2.zoom({newZoom:g,page:f,savePosition:!1})},300))}}}
function setSubmitStyle(b,a){var c=b.find(":submit");void 0===a&&(a=!c.hasClass("inactive"));if(a||"upgradeForm"==b.attr("id")){var d=b.data("existing")?"accept-existing":"accept";c.removeClass("inactive accept accept-existing").addClass(d).bounce()}else c.removeClass("accept accept-existing").addClass("inactive")}
function deleteObject(b,a){if((46==b||8==b||"delete"==b)&&!1==widget.editing){var c=$(".ui-selected");if(0==c.length)return!1;link.remove(c);((c=widget.del(c))||void 0===c)&&contextMenu.place("hide");return c}if(!a||!a.draggable)return!1;c=$(a.helper);return!0==intersectTrash(c)?(c.hasClass("pageWidget")?(link.remove(".ui-selected"),widget.del(".ui-selected"),widget._dragSelection=null):c.hasClass("screen")?page.del(c):c.hasClass("project")&&(1<account.get("projectIds").length?project.del($(a.draggable).attr("id")):
notification.add("info","Sorry, the currently open project cannot be deleted. Please create another project before deleting this one.")),$("#trash").removeClass("droppableStyle"),!0):!1}function redraw(){preview.multiOrientations=project.isMultiOrientation();preview.scaleFrame();$("#canvas").draggable("option","containment",canvas2.setContainment())}function Timeout(b,a){this.ms=b;this.callback=a;this.start()}
Timeout.prototype={start:function(){this.timeout||(this.msRemaining=this.ms,this.startTime=(new Date).valueOf(),this.isComplete=this.isPaused=!1,this._setTimeout(this.ms))},started:function(){return Boolean(this.timeout)},stop:function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null,this.isPaused=!1)},pause:function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null,this.msRemaining-=(new Date).valueOf()-this.startTime,this.isPaused=!0)},paused:function(){return Boolean(this.isPaused)},
resume:function(){this.isPaused&&!this.timeout&&(this.startTime=(new Date).valueOf(),this._setTimeout(this.msRemaining),this.isPaused=!1)},timeRemaining:function(){return this.isPaused?this.msRemaining:this.msRemaining-(new Date).valueOf()+this.startTime},exec:function(){this.stop();this.callback.call();this.isComplete=!0},complete:function(){return Boolean(this.isComplete)},_setTimeout:function(b){this.timeout=window.setTimeout(function(a){return function(){$.isFunction(a.callback)&&(a.isComplete=
!0,a.callback.call(),a.timeout=null)}}(this),b)}};function getScale(b,a,c,d){b=Math.min(b.width/(a.width+2*c),b.height/(a.height+2*c));d&&(b=b<d?d:b);return b};
